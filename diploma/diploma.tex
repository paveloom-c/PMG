\documentclass[a4paper, oneside, 14pt]{article}
\special{pdf:minorversion 6}

\usepackage{geometry}
\newgeometry{vmargin=20mm,hmargin={30mm,20mm}}

\linespread{1.0}

\usepackage{fontspec}
\defaultfontfeatures{Ligatures={TeX}}
\setmainfont{cmun}[
  Extension=.otf,
  UprightFont=*rm,
  ItalicFont=*ti,
  BoldFont=*bx,
  BoldItalicFont=*bi,
]
\setsansfont{cmun}[
  Extension=.otf,
  UprightFont=*ss,
  ItalicFont=*si,
  BoldFont=*sx,
  BoldItalicFont=*so,
]
\setmonofont{cmun}[
  Extension=.otf,
  UprightFont=*btl,
  ItalicFont=*bto,
  BoldFont=*tb,
  BoldItalicFont=*tx,
]
\usepackage[main=russian,english]{babel}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{gensymb}

\usepackage{tocloft}
\setcounter{tocdepth}{4}

\usepackage[bookmarks=false,hidelinks]{hyperref}
\hypersetup{pdfstartview={FitH}, pdfauthor={Павел Соболев}}

\hypersetup{pdftitle={Соболев (2023) - Пространственно-кинематическое моделирование плоской подсистемы Галактики методом наибольшего правдоподобия}}

\renewcommand{\figureautorefname}{рис.}
\renewcommand{\tableautorefname}{табл.}

\usepackage[table]{xcolor}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage{rotating}

\usepackage[justification=justified, format=plain]{caption}
\usepackage{float}
\usepackage{graphicx}
\usepackage{subfig}
\graphicspath{ {../results/} }
\DeclareGraphicsExtensions{.pdf}
\captionsetup[table]{name=Табл.}
\captionsetup{labelsep=period}

\usepackage[
  backend=biber,
  autolang=other,
  sorting=nty,
  style=phys,
  biblabel=brackets,
  maxbibnames=2,
  url=true,
]{biblatex}
\DeclareSourcemap {
   \maps {
      \map {
         \step [
            fieldsource=langid,
            match=russian,
            fieldset=presort,
            fieldvalue=1
         ]
      }
   }
}
\addbibresource{refs.bib}
\defbibheading{bibintoc}{\phantomsection\addcontentsline{toc}{section}{\bibname}\hyperlink{toc}{\section*{\bibname}}}
\AtEveryBibitem{
  \clearfield{urlyear}
  \clearfield{urlmonth}
}
\DeclareFieldFormat*{title}{#1}
\DeclareNameAlias{author}{last-first}
\DeclareNameWrapperFormat{sortname}{\mkbibitalic{#1}}
\DeclareNameWrapperAlias{author}{sortname}
\DeclareNameWrapperAlias{editor}{sortname}
\DeclareNameWrapperAlias{translator}{sortname}
\DeclareDelimFormat{finalnamedelim}{\addcomma\space}

\usepackage{indentfirst}

\usepackage{enumitem}

\makeatletter
\newcommand\subsubsubsection{\@startsection{paragraph}{4}{\z@}{-2.5ex\@plus -1ex \@minus -.25ex}{1.25ex \@plus .25ex}{\normalfont\normalsize\bfseries}}
\makeatother

\renewcommand{\thesection}{\arabic{section}.}
\renewcommand{\thesubsection}{\thesection\arabic{subsection}.}
\renewcommand{\thesubsubsection}{\thesubsection\arabic{subsubsection}.}
\renewcommand{\theparagraph}{\thesubsubsection\arabic{paragraph}.}

\newcommand{\npar}{\par\vspace{\baselineskip}}

\begin{document}

\begin{titlepage}
  \begin{center}
    {
      \Large
      \textbf{Санкт-Петербургский государственный университет}

      Математико-механический факультет\\
      Кафедра небесной механики\par
    }

    \vfill

    {
      \Large
      \textbf{Соболев Павел Леонидович}\\
      Выпускная квалификационная работа\par
    }

    \vspace{0.5cm}

    {
      \LARGE
      \textbf{Пространственно-кинематическое моделирование плоской подсистемы Галактики методом наибольшего правдоподобия}\par
    }

    \vspace{0.5cm}

    {
      \Large

      Уровень образования: специалитет\\
      Направление: 03.05.01 <<Астрономия>>\\
      Основная образовательная программа: СМ.5012.2017 <<Астрономия>>\par
    }

    \vfill

    \begin{flushright}
      \large

      Научный руководитель:\\
      кандидат физико-математических наук,\\
      доцент Кафедры небесной механики\\
      Никифоров И. И.\npar

      Рецензент:\\
      доктор физико-математических наук,\\
      главный научный сотрудник ГАО РАН\\
      Бобылев В. В.\par

    \end{flushright}

    \vfill

    {
      \Large
      Санкт-Петербург\\
      2023\par
    }
  \end{center}
\end{titlepage}

\begin{titlepage}
  \begin{center}
    {
      \Large
      \textbf{Saint-Petersburg State University}

      Mathematics \& Mechanics Faculty\\
      Chair of Celestial Mechanics\par
    }

    \vfill

    {
      \Large
      \textbf{Pavel Sobolev}\\
      Final qualification paper\par
    }

    \vspace{0.5cm}

    {
      \LARGE
      \textbf{Spatial-kinematic modelling of a flat subsystem of the Milky Way by the method of maximum likelihood}\par
    }

    \vfill

    \begin{flushright}
      \large

      Scientific supervisor:\\
      Candidate of Sciences in Physical and Mathematical Sciences,\\
      Associate Professor of the Chair of Celestial Mechanics\\
      I. Nikiforov\npar

      Reviewer:\\
      Doctor of Sciences in Physical and Mathematical Sciences,\\
      Chief Researcher of the Central Astronomical Observatory of the Russian Academy of Sciences at Pulkovo\\
      V. Bobylev\par

    \end{flushright}

    \vfill

    {
      \Large
      Saint-Petersburg\\
      2023\par
    }
  \end{center}
\end{titlepage}

\hypertarget{toc}{}
\tableofcontents

\setcounter{page}{3}

\newpage

\setcounter{secnumdepth}{-1}
\hyperlink{toc}{\section{Введение}}

Настоящая выпускная квалификационная работа посвящена пространственно-кинематическому моделированию плоской подсистемы Галактики. Под этим подразумевается построение аналитической кинематической модели Галактики и использование её для определения кинематических параметров (постоянной Оорта $ A $, угловой $ \omega_0 $ и линейной $ \theta_0 $ скоростей вращения на солнечном круге, угловой скорости Солнца $ \omega_\odot $, остаточной скорости Солнца, эллипсоида скоростей и других) совместно с определением масштабного параметра --- расстояния от Солнца до центра Галактики $ R_0 $. Как следствие, сюда же включается и построение галактической кривой вращения. Результаты достигаются путем решения связанной с моделью задачи оптимизации по выборке мазерных источников с имеющимися данными об их положениях и скоростях.

Определение $ R_0 $ является фундаментальной проблемой, попытки решения которой предпринимались на протяжении уже более сотни лет. В \cite{N.2003, N.2004} предложена классификация методов определения $ R_0 $ на пространственные, кинематические, динамические и нефазовые. Для каждого класса методов характерны различные источники систематических и случайных ошибок, оба варианта которых могут относиться как к определению ошибок расстояний до опорных объектов и других наблюдательных данных, так и к собственно методу определения $ R_0 $.

Первопроходцем в этом вопросе является Харлоу Шепли (1918) \cite{S.1918}, обнаруживший сильную концентрацию шаровых скоплений вблизи центра Галактики (ЦГ). Расстояние от Солнца до точки наибольшей концентрации получилось равным ${}\approx13$ кпк. Это был первый пространственный метод. В дальнейшем он модифицировался либо с целью устранения систематического эффекта селекции \cite{W.1975, F.W.1982, R.H.1989}, либо с целью его моделирования и учета \cite{R.P.D.F.1994}. Характерны также попытки устранить эффекты селекции другими методами: усечением $X$-распределения шаровых скоплений вблизи галактического центра (Харрис, 1976) \cite{H.1976} и использованием конуса избегания (Сасаки и Исизава, 1978) \cite{S.I.1978}. С открытием звезд типа RR Лиры появился метод Бааде (1946, 1951) \cite{B.1946, B.1951}, заключающийся в исследовании вблизи ЦГ так называемых <<окон прозрачности>> и определении расстояния до точки наибольшей плотности в каждом из них. Сам Бааде получил оценку $ R_0 $ = 8.7 кпк \cite{B.1951}. Этот метод также применялся и для других типов объектов (мириды, карликовые цефеиды, звезды красного сгущения). Всё это пространственные методы, требующие учета искажений истинного распределения объектов и статистических эффектов.

Кинематические методы направлены на анализ кинематики галактических подсистем с целью локализации динамического ЦГ (барицентра). В отличие от пространственных, кинематические методы менее подвержены эффектам наблюдательной селекции, однако главной проблемой является выбор модели. Первым, кто использовал подобный метод для определения расстояния до ЦГ, по всей видимости, является Камм (1938) \cite{C.1938}. По данным о 15 планетарных туманностях он вывел оценку $ R_0 = 9.83 \pm 0.11 $ кпк. В дальнейшем кинематические методы получили широкое развитие и приобрели популярность. Согласно предложенной в \cite{N.2003} классификации, кинематические методы могут варьироваться по четырем признакам: по составу модели, по виду дифференциального вращения в модели, по способу оптимизации модели относительно $ R_0 $ и по учету неопределенности опорных расстояний. В данной работе в состав модели закладывается явление дифференциального вращения Галактики, предполагаемое осесимметричным, а также определяется остаточное движение Солнца; вид дифференциального вращения описывается многочленом Тейлора, порядок которого оптимизируется; находится самосогласованное решение для выборки опорных объектов (внутренняя оптимизация 1-ого рода); учитываются неопределенности опорных расстояний путем минимизации квадратов отклонений от модели одновременно и по положениям, и по скоростям.

\textbf{Актуальность} решения этой задачи остается высокой, ведь сама задача фундаментальна и лежит в основе многих вопросов галактической и внегалактической астрономии и астрофизики. В частности, от значения $ R_0 $ зависят \cite{N.2003} абсолютный размер нашей Галактики и её светимость, величина линейной скорости вращения Галактики $ \theta_0 $ на $ R_0 $, кривая вращения Галактики. Знание $ R_0 $ также позволяет понять природу галактического центра: размер, массу и светимость центральной области и населяющих её объектов. От значения $ \theta_0 $ (как и от значения постоянной Оорта A) зависит вид кривой вращения (в частности, является ли она в среднем убывающей, или примерно плоской, или в среднем возрастающей), что сильно влияет на динамические выводы. Сам закон вращения требуется для определения кинематических расстояний до объектов (при заданном $ R_0 $); исследования распределения масс в Галактике; моделирования динамических эффектов, возмущающих осесимметричное вращение Галактики (в частности, для моделирования спиральных рукавов). Учет остаточного движения Солнца является важным не только для повышения корректности кинематической модели, но и для решения таких сложных проблем, как определение радиуса коротации Галактики.

Благодаря осознанию важности определения основных галактических характеристик на совершенствование методов моделирования Галактики было затрачено много усилий, однако вопрос получения достаточно точных для использования в большинстве приложений оценок этих параметров до сих пор остается открытым. Это является второй причиной актуальности данной работы. Так, полученные с середины 70-х гг. XX века оценки $ R_0 $ охватывают интервал от 6 до 10.5 кпк \cite{K.L.1986, F.1987, R.1993}. На основании найденного в обзоре \cite{K.L.1986} среднего арифметического $ R_0 = 8.54 \pm 1.1 $ кпк по 25 оценкам $ R_0 $, полученным в 1974-1986 гг., 33-я комиссия МАС рекомендовала использовать новое стандартное значение $ R_0 = 8.5 $ кпк, сменившее старый стандарт МАС 1964 г. $ R_0 = 10 $ кпк (см. \cite{F.T.1991}). В более поздних обзорах \cite{R.1993, N.2004} средняя оценка $ R_0 $ расположена около 8 кпк. Со временем разброс уменьшается, но медленно. В работах 90-х годов ХХ века и более поздних оценки варьировались от 6.5 до 9 кпк.

\textbf{Цель} данной работы --- разработать наиболее корректный метод пространственно"=кинематического моделирования и применить его к данным о подсистеме опорных объектов. Корректность здесь достигается использованием трехмерного поля скоростей (включаются данные и о лучевых скоростях, и о собственных движениях); определением остаточного движения Солнца; учетом вклада природной дисперсии; учетом случайных ошибок гелиоцентрических расстояний; оптимизацией порядка модели (порядка полинома Тейлора при разложении кривой вращения); использованием гибкого алгоритма для определения выбросов по невязкам \cite{N.2012}.

В качестве опорных объектов используются мазеры. Опорные расстояния данных объектов определяются абсолютными методами (параллаксы определяются напрямую геометрическим методом с помощью радиоинтерферометрии со сверхдлинной базой), а значит, сравнительно менее подвержены систематическим ошибкам, характерным при использовании относительных методов (например, при использовании шкал расстояний). Плюсом также является точность измерений: для большей части имеющихся измерений были определены ошибки параллаксов и собственных движений, не превышающие соответственно 10\% и 1 мсд год$^{-1}$, а зависимость ошибки параллакса обратно пропорциональна гелиоцентрическому расстоянию \cite{N.V.2018}. Этим во многом объясняется большой интерес к данному типу объектов в последнее время \cite{R.2009, R.2014, R.2019, B.B.2014, B.B.2015}. Минусом применения данного типа объектов является относительная малочисленность данных: по сравнению с наборами данных для звезд красного сгущения \cite{V.2019} (например, более 50 тысяч объектов в каталоге APOGEE-RC DR-17 \cite{DR17-APOGEE}), мазерных источников с полным набором кинематических данных на данный момент набирается чуть менее трёх сотен (хотя в целом их число всё же увеличивается со временем). Автором данной работы объединены и дополнены каталоги VERA (2020) \cite{VERA.2020} и Рид и др. (2019) \cite{R.2019}.

Все результаты доступны по следующим ссылкам:\npar

\begin{enumerate}[label={\arabic*)}]
  \item \url{https://drive.google.com/drive/folders/1L1lBVWZ8CMjjaifdMDBWdDOBWnpum_8D};
  \item \url{https://drive.google.com/drive/folders/1JsSwkPIN456PfPQSLpdbH9Gq_FcpahEo}.
\end{enumerate}

\newpage

\setcounter{secnumdepth}{4}

\hyperlink{toc}{\section[Пространственно-кинематическое моделирование плоской подсистемы Галактики]{Пространственно-кинематическое моделирование \\ плоской подсистемы Галактики}}

\hyperlink{toc}{\subsection{Основные предположения и определения}}

Использование кинематического метода определения $ R_0 $ и других параметров предполагает составление модели подсистемы Галактики. С этим связана проблема зависимости результата от модельных и оптимизационных предположений.\npar

\paragraph*{Предположения:}
\begin{enumerate}
\item Дифференциальное вращение Галактики является осесимметричным.
\item Остаточное движение Солнца может быть найдено в процессе оптимизации.
\item Глобальное расширение/сжатие Галактики отсутствует.
\item Влияние спиральной структуры Галактики \cite{B.O.1978} не учитывается, отчасти в качестве упрощающего предположения, отчасти из-за того, что природа спиральной структуры еще нуждается в установлении.
\item К-член (член Кемпбелла, эмпирическая постоянная добавка в уравнениях для лучевой скорости) \cite{K.1978} полагается равным нулю.
\item Эллиптическая дисторсия галактического диска \cite{M.C.S.1998} не включается в модель как эффект, нуждающийся в подтверждении.
\item Оптимальный порядок $ n $ аппроксимирующего закон вращения полинома Тейлора может быть найден в ходе решения.
\end{enumerate}

\paragraph*{Определения:}
\begin{enumerate}
\item Модельная скорость заданного объекта --- скорость центроида объектов
данного типа, вычисленная для положения этого объекта.
\item Стандарт покоя подсистемы (СПП) --- гелиоцентрическая система отсчета, по отношению к которой среднее азимутальное движение объектов подсистемы, находящихся сейчас в области солнечного кольца (в окрестности солнечного круга $ R = R_0 $), равно нулю, а также равны нулю среднее движение вдоль координаты $ X $ и среднее вертикальное движение всех объектов подсистемы (рассматриваемой выборки). Иными словами, СПП в данную эпоху проходит через местоположение Солнца с азимутальной скоростью, равной средней азимутальной скорости объектов из области солнечного кольца, и с $X$- и $Z$-компонентами скорости, равными средним $X$- и $Z$-скоростям объектов всей выборки.
\end{enumerate}

\hyperlink{toc}{\subsection{Выражения для модельных величин наблюдаемых компонент 3D-скоростей}}

\hyperlink{toc}{\subsubsection{Лучевые скорости}}

В предположении чисто кругового вращения модельная величина гелиоцентрической лучевой скорости данного объекта, $ V_{r,\text{mod}} $, в общем случае определяется выражениями
%
\begin{align}
  V_{r,\text{mod}} &= V_{r,rot} + V_{r,\odot},\\
  \label{eq:v_r_rot}
  V_{r,\text{rot}} &= (\omega - \omega_0) R_0 \sin{l} \cos{b},\\
  V_{r,\odot} &= -u_\odot \cos{l} \cos{b} - v_\odot \sin{l} \cos{b} - w_\odot \sin{b},
\end{align}
%
где $ V_{r,\text{rot}} $ и $ V_{r,\odot} $ --- влияние на модельную лучевую скорость объекта вращения подсистемы и движения Солнца относительно СПП, соответственно; $ \omega $ --- угловая скорость вращения подсистемы для точки, где находится рассматриваемый объект; $ \omega_0 $ --- угловая скорость СПП; $ u_\odot $, $ v_\odot $, $ w_\odot $ --- компоненты остаточной скорости Солнца, т.е. компоненты движения Солнца относительно СПП в направлениях $ (l, b) = (0\degree, 0\degree) $, $ (l, b) = (90\degree, 0\degree) $ и $ b = 90\degree $, соответственно; $ l $ и $ b $ --- галактические координаты объекта.

В случае плоской подсистемы линейная скорость вращения центроидов $ \theta = \theta(R) $. Используем для представления $ \theta = \theta(R) $ модельный полином в виде многочлена Тейлора:
%
\begin{equation}
  \label{eq:model}
  \Theta_n(R) = \sum_{i=0}^n \frac{\theta_i}{i!} (\Delta R)^i, \quad n \ge 1, \quad \theta_i = \left. \frac{d^i \theta}{d R^i} \right|_{R = R_0},
\end{equation}
%
где
%
\begin{equation}
  \Delta R \equiv R - R_0, \quad R = \sqrt{R_0^2 + r^2 \cos{b}^2 - 2 R_0 r \cos{l} \cos{b}}.
\end{equation}
%
Здесь $ R $ --- галактоосевое расстояние, $ r $ --- гелиоцентрическое расстояние до объекта.

Тогда модель \eqref{eq:v_r_rot} принимает общий вид
%
\begin{equation}
  V_{r,\text{rot}} = \left[ -2 A \Delta R + \sum_{i=2}^n \frac{\theta_i}{i!} (\Delta R)^i \right] \frac{R_0}{R} \sin{l} \cos{b},
\end{equation}
%
\begin{equation}
  \label{eq:A}
  A \equiv - \frac{1}{2} R_0 \omega'(R_0) = - \frac{1}{2} (\theta_1 - \omega_0).
\end{equation}

\hyperlink{toc}{\subsubsection{Собственные движения по долготе}}

Определение: $ \mu_l \equiv \frac{dl}{dt} $, $ \mu_l' \equiv \frac{dl}{dt} \cos{b} = \mu_l \cos{b} $. В обозначениях, аналогичных использованным в случае $ V_r $, для модельного полинома \eqref{eq:model}
%
\begin{align}
  k \mu_{l,\text{mod}}' &= k \mu_{l,\text{rot}}' + k \mu_{l,\odot}',\\
  k \mu_{l,\text{rot}}' &= \left[ -2 A \Delta R + \sum_{i=2}^n \frac{\theta_i}{i!} (\Delta R)^i \right] \left( \frac{R_0 \cos{l}}{r} - \cos{b} \right) R^{-1} - \omega_0 \cos{b},\\
  k \mu_{l,\odot}' &= (u_\odot \sin{l} - v_\odot \cos{l}) / r,
\end{align}
%
где $ k = 4.7406 $ для $ r $ в кпк и $ \mu $ в мсд год$^{-1}$ \cite{G.N.O.2016}.

\hyperlink{toc}{\subsubsection{Собственные движения по широте}}

Определение: $ \mu_b \equiv \frac{db}{dt} $. Аналогично:
%
\begin{align}
  k \mu_{b,\text{mod}} &= k \mu_{b,\text{rot}} + k \mu_{b,\odot},\\
  k \mu_{b,\text{rot}} &= \left[ 2 A \Delta R - \sum_{i=2}^n \frac{\theta_i}{i!} (\Delta R)^i \right] \frac{R_0}{R r} \sin{l} \sin{b},\\
  k \mu_{b,\odot} &= (u_\odot \cos{l} \sin{b} + u_\odot \sin{l} \sin{b} - w_\odot \cos{b}) / r,
\end{align}

\hyperlink{toc}{\subsection{Формулы редукции в случае мазеров}}

\hyperlink{toc}{\subsubsection{Переход от экваториальных сферических координат к галактическим}}

Если экваториальные координаты приведены на эпоху J2000.0, то $(l, b)$ связаны с $(\alpha, \delta)$ как
%
\begin{align}
  \label{eq:lb_start}
  \sin{b} &= \sin{\delta} \cos{(90\degree - \delta_p)} - \cos{\delta} \sin{(\alpha - \alpha_p - 6^\text{h})} \sin{(90\degree - \delta_p)},\\
  l &= \phi + (\theta - 90\degree),\\
  \sin{\phi} &= \left[ \cos{\delta} \sin{(\alpha - \alpha_p - 6^\text{h})} \cos{(90\degree - \delta_p)} + \sin{\delta} \sin{(90\degree - \delta_p)} \right] / \cos{b},\\
  \label{eq:lb_end}
  \cos{\phi} &= \cos{\delta} \cos{(\alpha - \alpha_p - 6^\text{h})} / \cos{b},
\end{align}
%
где $ \alpha_p = 12^\text{h} 51^\text{m} 26^\text{s}.2817 $, $ \delta_p = 27\degree07'42''.013 $, $ \theta = 122\degree.932 $, $ \phi \in [0; 360) $ \cite{R.B.2004, R.2009}.

\pagebreak[3]

\hyperlink{toc}{\subsubsection{Преобразование собственного движения в экваториальных координатах в собственное движение в галактических координатах}}

В каталогах непосредственно приведены $ \mu_x = \mu_\alpha \cos{\delta} $ и $ \mu_y = \mu_\delta $ (\cite{R.2009} и последующие работы). Согласно рецепту Reid и др. (2009) \cite{R.2009},
%
\begin{equation}
  \mu_l = l(\alpha + \mu_\alpha, \delta + \mu_\delta) - l(\alpha, \delta), \quad \mu_b = b(\alpha, \delta),
\end{equation}
%
где $ l(\alpha, \delta) $, $ b(\alpha, \delta) $ находятся по формулам \eqref{eq:lb_start}--\eqref{eq:lb_end}. Измерительные дисперсии $ \tilde{\sigma}_{\mu_l'}^2 $ и $ \tilde{\sigma}_{\mu_b}^2 $, являющиеся функциями от $ \mu_x $ и $ \mu_y $, определяются по формуле распространения ошибок:
%
\begin{align}
  \label{eq:tilde_sigma_mu_l}
  \tilde{\sigma}_{\mu_l'}^2 &= \left( \frac{\partial \mu_l'}{\partial \mu_x} \right)^2 \tilde{\sigma}_{\mu_x}^2 + \left( \frac{\partial \mu_l'}{\partial \mu_y} \right)^2 \tilde{\sigma}_{\mu_y}^2,\\
  \label{eq:tilde_sigma_mu_b}
  \tilde{\sigma}_{\mu_b}^2 &= \left( \frac{\partial \mu_b}{\partial \mu_x} \right)^2 \tilde{\sigma}_{\mu_x}^2 + \left( \frac{\partial \mu_b}{\partial \mu_y} \right)^2 \tilde{\sigma}_{\mu_y}^2.
\end{align}

\hyperlink{toc}{\subsubsection{Восстановление гелиоцентрической скорости по скорости относительно Местного стандарта покоя}}

В каталоге приведены $ V_\text{LSR} $, вычисленные для стандартного движения Солнца $ V_\odot = 20 $ км/с в направлении $ \alpha(1900) = 18^\text{h} $, $ \delta(1900) = +30\degree $, обычно принимаемого в обсерваториях при обработке радионаблюдений \cite{R.2009}. Параметры этого движения:
%
\begin{equation}
  u_\odot = 10.3 \text{ км/с}, \quad u_\odot = 15.3 \text{ км/с}, \quad w_\odot = 7.7 \text{ км/с}.
\end{equation}
%
Тогда
%
\begin{equation}
  V_r = V_\text{LSR} - u_\odot \cos{l} \cos{b} - v_\odot \sin{l} \cos{b} - w_\odot \sin{b}.
\end{equation}

\hyperlink{toc}{\subsection{Преобразование лучевой скорости и собственного движения в линейные компоненты 3D-скорости для разных систем координат}}

\hyperlink{toc}{\subsubsection{Вычисление компонент скорости в галактических координатах}}

В общем случае
%
\begin{equation}
  \label{eq:V_l_V_b}
  V_l \equiv r \mu_l' = r \mu_l \cos{b} = r \frac{dl}{dt} \cos{b}, \quad V_b = r \mu_b = r \frac{db}{dt}.
\end{equation}
%
Для компонент скорости, выраженных в километрах в секунду,
%
\begin{equation}
  \label{eq:V_l_V_b_with_k}
  V_l \; [\text{км/с}] = k r \mu_l \cos{b} = k r \mu_l', \quad V_b \; [\text{км/с}] = k r \mu_b,
\end{equation}
%
где $ k = 4.7406 $ для $ r $ в кпк и $ \mu $ в мсд/год = mas y$^{-1}$, $ r $ [кпк] = $ 1 / \varpi $, где $ \varpi $ [мсд] --- параллакс, приведенный в каталоге.

\hyperlink{toc}{\subsubsection{Переход к компонентам скорости в декартовых гелиоцентрических координатах}}

Декартовы гелиоцентрические координаты:
%
\begin{align}
  X &= r \cos{l} \cos{b},\\
  Y &= r \sin{l} \cos{b},\\
  Z &= r \sin{b}.
\end{align}
%
Тогда компоненты скорости в этих координатах выражаются следующим образом:
%
\begin{align}
  U &\equiv \dot{X} = V_r \cos{l} \cos{b} - r \sin{l} \, \mu_l \cos{b} - r \cos{l} \sin{b} \, \mu_b,\\
  V &\equiv \dot{Y} = V_r \sin{l} \cos{b} + r \cos{l} \, \mu_l \cos{b} - r \sin{l} \sin{b} \, \mu_b,\\
  W &\equiv \dot{Z} = V_r \sin{b} + r \cos{b} \, \mu_b,
\end{align}
%
или, учитывая \eqref{eq:V_l_V_b},
%
\begin{align}
  \label{eq:U}
  U &= (V_r \cos{b} - V_b \sin{b}) \cos{l} - V_l \sin{l},\\
  \label{eq:V}
  V &= (V_r \cos{b} - V_b \sin{b}) \sin{l} + V_l \cos{l},\\
  \label{eq:W}
  W &= V_b \cos{b} + V_r \sin{b}.
\end{align}
%
Для вычисления $ U $, $ V $ и $ W $, выраженных в километрах в секунду, в \eqref{eq:U}--\eqref{eq:W} следует подставлять значения $ V_l $ и $ V_b $, найденные по формулам \eqref{eq:V_l_V_b_with_k}.

\hyperlink{toc}{\subsubsection{Переход к галактоцентрической системе координат, связанной с Солнцем}}

Согласно формализму работы \cite{R.2009},
%
\begin{equation}
  \label{eq:U_g_V_g_W_g}
  U_\text{g} = U + u_\odot, \quad V_\text{g} = V + \theta_\odot, \quad W_\text{g} = W + w_\odot,
\end{equation}
%
где используются значения компонент остаточного движения Солнца $ u_\odot $, $ w_\odot $ и линейной скорости вращения Солнца вокруг центра Галактики $ \theta_\odot = R_0 \omega_0 + v_\odot $, найденные при использовании уравнений раздела 1.1 по данным о скоростях и расстояниях, или, при отсутствии такого решения, подставляются результаты из \cite{R.2019}, полученные по мазерам: $ u_\odot = 10.7 $ км с$^{−1}$, $ \theta_\odot = 247 $ км с$^{−1}$, $ w_\odot = 7.7 $ км с$^{−1}$ (здесь $ u_\odot = u_\text{LSR} $ и $ w_\odot = w_\text{LSR} $ --- компоненты пекулярной скорости Солнца относительно МСП).

\hyperlink{toc}{\subsubsection{Переход к галактоцентрической системе координат, связанной с объектом}}

\hyperlink{toc}{\subsubsubsection{$\Lambda$-параметризация}}

Согласно формализму работы \cite{R.2009},
%
\begin{align}
  \label{eq:Pi}
  \Pi &\equiv -\dot{R} = U_\text{g} \cos{\Lambda} - V_\text{g} \sin{\Lambda},\\
  \label{eq:theta}
  \theta &\equiv \dot{\Lambda} R = U_\text{g} \sin{\Lambda} + V_\text{g} \cos{\Lambda},\\
  \Upsilon &\equiv \dot{Z} = W_\text{g}.
\end{align}
%
Здесь $ \Lambda $ --- галактоцентрическая долгота объекта, которая отсчитывается от направления из центра Галактики на Солнце в сторону вращения Галактики:
%
\begin{equation}
  \sin{\Lambda} = \frac{r \cos{b}}{R} \sin{l}, \quad \cos{\Lambda} = \frac{R_0 - r \cos{b} \cos{l}}{R};
\end{equation}
%
$ \Pi $, $ \theta $, $ \Upsilon $ --- радиальная (положительная к центру Галактики), азимутальная и вертикальная (положительная к северному полюсу Галактики) скорости объекта, соответственно. При отсутствии собственной оценки $ R_0 = 8.15 $ кпк \cite{R.2019}.

\hyperlink{toc}{\subsubsubsection{$\varphi$-параметризация}}

Вместо угла $ \Lambda $ можно ввести угол $ \varphi $ с вершиной в точке $ O' $ проекции объекта $ O $ на плоскость Галактики между направлением на центр Галактики и линией $ l = \text{const} $, $ b = 0\degree $ (между проекциями большой оси эллипсоида скоростей и луча зрения на плоскость Галактики) \cite{R.2017}. Угол $ \varphi $ отсчитывается против часовой стрелки, если смотреть с северного полюса Галактики. Очевидно, что $ \Lambda + l + \pi − \varphi = \pi $. Отсюда
%
\begin{equation}
  \label{eq:lambda_varphi}
  \Lambda = \varphi - l, \quad \varphi = \Lambda + l.
\end{equation}
%
Тогда
%
\begin{align}
  \label{eq:sin_phi}
  \sin{\varphi} &= \sin{\Lambda} \cos{l} + \cos{\Lambda} \sin{l},\\
  \label{eq:cos_phi}
  \cos{\varphi} &= \cos{\Lambda} \cos{l} - \sin{\Lambda} \sin{l},
\end{align}
%
или в силу \eqref{eq:lambda_varphi}
%
\begin{align}
  \notag
  \sin{\varphi} &= \frac{r \cos{b}}{R} \sin{l} \cos{l} + \frac{R_0 - r \cos{b} \cos{l}}{R} \sin{l} =\\
  &= \frac{\sin{l}}{R} (r \cos{b} \cos{l} + R_0 - r \cos{b} \cos{l}) = \frac{R_0 \sin{l}}{R}.\\
  \notag
  \cos{\varphi} &= \frac{R_0 - r \cos{b} \cos{l}}{R} \cos{l} - \frac{r \cos{b}}{R} \sin^2{l} =\\
  &= \frac{1}{R} (R_0 \cos{l} - r \cos{b} \cos^2{l} - r \cos{b} \sin^2{l}) = \frac{R_0 \cos{l} - r \cos{b}}{R}.
\end{align}

$\Lambda$-параметризация удобнее при выражении галактоцентрических компонент скоростей через наблюдаемые компоненты. $\varphi$-параметризация, наоборот, удобнее при представлении наблюдаемых компонент через галактоцентрические.

\hyperlink{toc}{\subsection{Вклад эллипсоида скоростей в природные дисперсии измеренных компонент скорости объекта}}

\hyperlink{toc}{\subsubsection{Выражение компонент скорости $ V_r $, $ V_l $ и $ V_b $ через компоненты $ U $, $ V $ и $ W $}}

\hyperlink{toc}{\subsubsubsection{$ V_r $ в функции $ U $, $ V $ и $ W $}}

Используя \eqref{eq:W}, запишем:
%
\begin{equation}
  \label{eq:V_b}
  V_b = \frac{W - V_r \sin{b}}{\cos{b}}.
\end{equation}
%
Комбинируя \eqref{eq:U} и \eqref{eq:V} и подставляя \eqref{eq:V_b}, получаем:
%
\begin{gather}
  \nonumber
  U \cos{l} + V \sin{l} = V_r \cos{b} - V_b \sin{b} = V_r \cos{b} - \frac{W \sin{b}}{\cos{b}} + \frac{V_r \sin^2{b}}{\cos{b}} = \frac{V_r}{\cos{b}} - \frac{W \sin{b}}{\cos{b}}, \implies\\
  \label{eq:V_r}
  V_r = U \cos{l} \cos{b} + V \sin{l} \cos{b} + W \sin{b}.
\end{gather}

\hyperlink{toc}{\subsubsubsection{$ V_l $ в функции $ U $ и $ V $}}

Комбинируя \eqref{eq:U} и \eqref{eq:V}, получаем:
%
\begin{gather}
  \nonumber
  U \sin{l} - V \cos{l} = -V_l \sin^2{l} - V_l \cos^2{l} = -V_l, \implies\\
  \label{eq:V_l}
  V_l = -U \sin{l} + V \cos{l}.
\end{gather}

\hyperlink{toc}{\subsubsubsection{$ V_b $ в функции $ U $, $ V $ и $ W $}}

Подставляя \eqref{eq:V_r} в \eqref{eq:V_b}, получаем:
%
\begin{gather}
  \nonumber
  V_b = \frac{W}{\cos{b}} - U \cos{l} \sin{b} - V \sin{l} \sin{b} - W \frac{\sin^2{b}}{\cos{b}}, \implies\\
  \label{eq:V_b}
  V_b = -U \cos{l} \sin{b} - V \sin{l} \sin{b} + W \cos{b}.
\end{gather}

\hyperlink{toc}{\subsubsection{Дисперсии компонент скорости $ V_r $, $ V_l $, $ V_b $ и собственных движений $ \mu_l' $, $ \mu_b $ как функции дисперсий компонент $ U $, $ V $ и $ W $}}

Из выражений \eqref{eq:V_r}--\eqref{eq:V_b} в предположении отсутствия корреляции между $ U $, $ V $ и $ W $ по формуле распространения ошибок получаем следующие выражения для природных дисперсий линейных скоростей:
%
\begin{align}
  \sigma_{V_r}^{\ast 2} &= \sigma_U^2 \cos^2{l} \cos^2{b} + \sigma_V^2 \sin^2{l} \cos^2{b} + \sigma_W^2 \sin^2{b},\\
  \sigma_{V_l}^{\ast 2} &= \sigma_U^2 \sin^2{l} + \sigma_V^2 \cos^2{l},\\
  \sigma_{V_b}^{\ast 2} &= \sigma_U^2 \cos^2{l} \sin^2{b} + \sigma_V^2 \sin^2{l} \sin^2{b} + \sigma_W^2 \cos^2{b}.
\end{align}
%
В силу \eqref{eq:V_l_V_b_with_k} $ \mu_l' = V_l / (k r) $. Тогда для дисперсий собственных движений имеем:
%
\begin{align}
  \sigma_{\mu_l'}^{\ast 2} &= \frac{1}{k^2 r^2} (\sigma_U^2 \sin^2{l} + \sigma_V^2 \cos^2{l}),\\
  \sigma_{\mu_b}^{\ast 2} &= \frac{1}{k^2 r^2} (\sigma_U^2 \cos^2{l} \sin^2{b} + \sigma_V^2 \sin^2{l} \sin^2{b} + \sigma_W^2 \cos^2{b}).
\end{align}

\hyperlink{toc}{\subsubsection{Выражение компонент скорости $ V_r $, $ V_l $ и $ V_b $ через компоненты $ \Pi $, $ \theta $ и $ \Upsilon $}}

Комбинируя \eqref{eq:Pi} и \eqref{eq:theta}, запишем компоненты скорости $ U_\text{g} $, $ V_\text{g} $ и $ W_\text{g} $ как функции компонент $ \Pi $, $ \theta $ и $ \Upsilon $:
%
\begin{align}
  \Pi \cos{\Lambda} + \theta \sin{\Lambda} &= U_\text{g} \cos^2{\Lambda} + U_\text{g} \sin^2{\Lambda} = U_\text{g},\\
  \Pi \sin{\Lambda} - \theta \cos{\Lambda} &= -V_\text{g} \sin^2{\Lambda} - V_\text{g} \cos^2{\Lambda} = -V_\text{g}.
\end{align}
%
Таким образом,
%
\begin{align}
  \label{eq:U_g}
  U_\text{g} &= \Pi \cos{\Lambda} + \theta \sin{\Lambda},\\
  V_\text{g} &= -\Pi \sin{\Lambda} + \theta \cos{\Lambda},\\
  \label{eq:W_g}
  W_\text{g} &= \Upsilon.
\end{align}

\hyperlink{toc}{\subsubsubsection{В $\Lambda$-параметризации}}

Подставим \eqref{eq:U_g}--\eqref{eq:W_g} в \eqref{eq:V_r}, учитывая \eqref{eq:U_g_V_g_W_g}:
%
\begin{align}
  \label{eq:V_r_Lambda}\nonumber
  V_r &= (U_\text{g} - u_\odot) \cos{l} \cos{b} + (V_\text{g} - \theta_\odot) \sin{l} \cos{b} + (W_\text{g} - w_\odot) \sin{b} =\\
  \nonumber
  &= (\Pi \cos{\Lambda} + \theta \sin{\Lambda} - u_\odot) \cos{l} \cos{b} + (-\Pi \sin{\Lambda} + \theta \cos{\Lambda} - \theta_\odot) \sin{l} \cos{b} + {}\\
  &+ (\Upsilon - w_\odot) \sin{b}.
\end{align}

Подставим \eqref{eq:U_g}--\eqref{eq:W_g} в \eqref{eq:V_l}, учитывая \eqref{eq:U_g_V_g_W_g}:
%
\begin{align}
  \label{eq:V_l_Lambda}\nonumber
  V_l &= -(U_\text{g} - u_\odot) \sin{l} + (V_\text{g} - \theta_\odot) \cos{l} =\\
  &= -(\Pi \cos{\Lambda} + \theta \sin{\Lambda} - u_\odot) \sin{l} + (-\Pi \sin{\Lambda} + \theta \cos{\Lambda} - \theta_\odot) \cos{l}.
\end{align}

Подставим \eqref{eq:U_g}--\eqref{eq:W_g} в \eqref{eq:V_b}, учитывая \eqref{eq:U_g_V_g_W_g}:
%
\begin{align}
  \label{eq:V_b_Lambda}\nonumber
  V_b &= -(U_\text{g} - u_\odot) \cos{l} \sin{b} - (V_g - \theta_\odot) \sin{l} \sin{b} + (W_g - w_\odot) \cos{b} =\\
  \nonumber
  &= -(\Pi \cos{\Lambda} + \theta \sin{\Lambda} - u_\odot) \cos{l} \sin{b} - (-\Pi \sin{\Lambda} + \theta \cos{\Lambda} - \theta_\odot) \sin{l} \sin{b} + {}\\
  &+ (\Upsilon - w_\odot) \cos{b}.
\end{align}

\hyperlink{toc}{\subsubsubsection{В $\varphi$-параметризации}}

Сгруппировав в \eqref{eq:V_r_Lambda}--\eqref{eq:V_b_Lambda} члены при $ \Pi $ и $ \theta $ и используя соотношения \eqref{eq:sin_phi}--\eqref{eq:cos_phi}, получаем
%
\begin{align}
  \label{eq:V_r_phi}\nonumber
  V_r &= \Pi (\cos{\Lambda} \cos{l} - \sin{\Lambda} \sin{l}) \cos{b} + \theta (\sin{\Lambda} \cos{l} + \cos{\Lambda} \sin{l}) \cos{b} + \Upsilon \sin{b} - {}\\
  \nonumber
  &- u_\odot \cos{l} \cos{b} - \theta_\odot \sin{l} \cos{b} - w_\odot \sin{b} = {}\\
  &= \Pi \cos{\varphi} \cos{b} + \theta \sin{\varphi} \cos{b} + \Upsilon \sin{b} - u_\odot \cos{l} \cos{b} - \theta_\odot \sin{l} \cos{b} - w_\odot \sin{b},\\
  V_l &= -\Pi \sin{\varphi} + \theta \cos{\varphi} + u_\odot \sin{l} - \theta_\odot \cos{l},\\
  \label{eq:V_b_phi}
  V_b &= -\Pi \cos{\varphi} \sin{b} - \theta \sin{\varphi} \sin{b} + \Upsilon \cos{b} + u_\odot \cos{l} \sin{b} + \theta_\odot \sin{l} \sin{b} - w_\odot \cos{b}.
\end{align}
%
Здесь коэффициенты при $ \Pi $, $ \theta $ и $ \Upsilon $ соответствуют элементам матрицы $ G_S $ в \cite{R.2017}.

\hyperlink{toc}{\subsubsection{Дисперсии компонент скорости $ V_r $, $ V_l $, $ V_b $ и собственных движений $ \mu_l' $, $ \mu_b $ как функции дисперсий компонент $ \Pi $, $ \theta $ и $ \Upsilon $}}

\hyperlink{toc}{\subsubsubsection{В $\Lambda$-параметризации}}

Из выражений \eqref{eq:V_r_Lambda}--\eqref{eq:V_b_Lambda} в предположении отсутствия корреляции между $ \Pi $, $ \theta $ и $ \Upsilon $ по формуле распространения ошибок получаем соотношения для природных дисперсий линейных скоростей в функции дисперсий $ \mathbb{D} \Pi \equiv \sigma_R^2 $, $ \mathbb{D} \theta \equiv \sigma_\theta^2 $ и $ \mathbb{D} \Upsilon = \mathbb{D} W_g = \mathbb{D} W \equiv \sigma_Z^2 $:
%
\begin{align}
  \label{eq:sigma_V_r_ast_Lambda}\nonumber
  \sigma_{V_r}^{\ast 2} = {} & \sigma_R^2 (\cos^2{\Lambda} \cos^2{l} \cos^2{b} - 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} \cos^2{b} + \sin^2{\Lambda} \sin^2{l} \cos^2{b}) + {}\\
  \nonumber
  {} + {} & \sigma_\theta^2 (\sin^2{\Lambda} \cos^2{l} \cos^2{b} + 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} \cos^2{b} + \cos^2{\Lambda} \sin^2{l} \cos^2{b}) + {}\\
  \nonumber
  {} + {} & \sigma_Z^2 \sin^2{b} = {}\\
  \nonumber
  {} = {} & \sigma_R^2 (\cos^2{\Lambda} \cos^2{l} - 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} + \sin^2{\Lambda} \sin^2{l}) \cos^2{b} + {}\\
  {} + {} & \sigma_\theta^2 (\sin^2{\Lambda} \cos^2{l} + 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} + \cos^2{\Lambda} \sin^2{l}) \cos^2{b} + \sigma_Z^2 \sin^2{b},\\
  \nonumber
  \sigma_{V_l}^{\ast 2} = {} & \sigma_R^2 (\cos^2{\Lambda} \sin^2{l} + 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} + \sin^2{\Lambda} \cos^2{l}) + {}\\
  {} + {} & \sigma_\theta^2 (\sin^2{\Lambda} \sin^2{l} - 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} + \cos^2{\Lambda} \cos^2{l}),\\
  \label{eq:sigma_V_b_ast_Lambda}\nonumber
  \sigma_{V_b}^{\ast 2} = {} & \sigma_R^2 (\cos^2{\Lambda} \cos^2{l} - 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} + \sin^2{\Lambda} \sin^2{l}) \sin^2{b} + {}\\
  {} + {} & \sigma_\theta^2 (\sin^2{\Lambda} \cos^2{l} + 2 \sin{\Lambda} \cos{\Lambda} \sin{l} \cos{l} + \cos^2{\Lambda} \sin^2{l}) \sin^2{b} + \sigma_Z^2 \cos^2{b}.
\end{align}

\hyperlink{toc}{\subsubsubsection{В $\varphi$-параметризации}}

Применяя к \eqref{eq:V_r_phi}--\eqref{eq:V_b_phi} формулу распространения ошибок в тех же предположениях или используя \eqref{eq:sigma_V_r_ast_Lambda}--\eqref{eq:sigma_V_b_ast_Lambda} с учетом соотношений \eqref{eq:sin_phi}--\eqref{eq:cos_phi} для $ \varphi $, находим выражения для дисперсий в этой параметризации:
%
\begin{align}
  \sigma_{V_r}^{\ast 2} &= \sigma_R^2 \cos^2{\varphi} \cos^2{b} + \sigma_\theta^2 \sin^2{\varphi} \cos^2{l} + \sigma_Z^2 \sin^2{b},\\
  \sigma_{V_l}^{\ast 2} &= \sigma_R^2 \sin^2{\varphi} + \sigma_\theta^2 \cos^2{\varphi},\\
  \sigma_{V_b}^{\ast 2} &= \sigma_R^2 \cos^2{\varphi} \sin^2{b} + \sigma_\theta^2 \sin^2{\varphi} \sin^2{b} + \sigma_Z^2 \cos^2{b}.
\end{align}
%
Природные стандарты собственных движений находятся по общим формулам:
%
\begin{equation}
  \label{eq:sigma_mu_l'_mu_b}
  \sigma_{\mu_l'}^\ast = \frac{\sigma_{V_l}^\ast}{k r}, \quad \sigma_{\mu_b}^\ast = \frac{\sigma_{V_b}^\ast}{k r}.
\end{equation}

\hyperlink{toc}{\section{Алгоритм с учетом случайных ошибок гелиоцентрических расстояний}}

\hyperlink{toc}{\subsection{Уровень I. Решения для $ n = \text{const} $ и фиксированной выборки из $ N $ объектов}}

Пусть расстояния $ r $ определяются методом тригонометрического параллакса: $ r $ = $ 1 / \varpi $, где $ \varpi $ --- измеренное значение параллакса со средней ошибкой измерения $ \sigma_\varpi $. Тогда функция правдоподобия в случае моделирования поля 3D-скоростей является произведением четырех плотностей вероятностей, соответствующих нормально распределенным случайным величинам $ V_r $, $ \mu_l' $, $ \mu_b $ и $ \varpi $:
%
\begin{align}
  \nonumber
  L = \prod_{j = 1}^N & \frac{1}{\sqrt{2 \pi} (\sigma_{V_r})_j} \exp{\left\{ \frac{[ V_{r,j} - V_{r,\text{mod}} (\varpi_{0,j}) ]^2}{2 (\sigma_{V_r})_j^2} \right\}} \frac{1}{\sqrt{2 \pi} (\sigma_{\mu_l'})_j} \exp{\left\{ \frac{[ \mu_{l,j}' - \mu_{l,\text{mod}}' (\varpi_{0,j}) ]^2}{2 (\sigma_{\mu_l'})_j^2} \right\}} \times {}\\
  {} \times {} & \frac{1}{\sqrt{2 \pi} (\sigma_{\mu_b})_j} \exp{\left\{ \frac{[ \mu_{b,j} - \mu_{b,\text{mod}} (\varpi_{0,j}) ]^2}{2 (\sigma_{\mu_b})_j^2} \right\}} \frac{1}{\sqrt{2 \pi} \sigma_{\varpi,j}} \exp{\left\{ \frac{(\varpi_j - \varpi_{0,j})^2}{2 \sigma_{\varpi,j}^2} \right\}}
\end{align}
%
где $ V_{r,j} $, $ \mu_{l,j}' $, $ \mu_{b,j} $ и $ \varpi_j $ --- каталожные (измеренные) значения $ V_r $, $ \mu_l' $, $ \mu_b $ и $ \varpi $ для $j$-го объекта; $ \varpi_{0,j} $ --- приведенное значение параллакса $j$-го объекта. Итоговые дисперсии скоростных характеристик для $j$-го объекта представляют собой суммы двух составляющих:
%
\begin{align}
  \label{eq:D_V_r}
  (\sigma_{V_r})_j^2 &= (\tilde{\sigma}_{V_r})_j^2 + (\sigma_{V_r}^\ast)_j^2,\\
  \label{eq:D_mu_l'}
  (\sigma_{\mu_l'})_j^2 &= (\tilde{\sigma}_{\mu_l'})_j^2 + (\sigma_{\mu_l'}^\ast)_j^2,\\
  \label{eq:D_mu_b}
  (\sigma_{\mu_b})_j^2 &= (\tilde{\sigma}_{\mu_b})_j^2 + (\sigma_{\mu_b}^\ast)_j^2,
\end{align}
%
где $ \tilde{\sigma}_j^2 $ --- измерительная дисперсия, $ \sigma_j^{\ast 2} = \sigma_j^{\ast 2}(l_j, b_j, \varpi_{0,j}; \sigma_R, \sigma_\theta, \sigma_Z) $ --- вклад природной дисперсии. Приведенный параллакс рассматривается как нормально распределенная случайная величина $ \Pi_{0,j} \sim \mathrm{N}(\varpi_j, \sigma_{\varpi,j}^2) $. Тройка величин $ (l_j, b_j, \varpi_{0,j}) $ определяет точку (неортогональной) проекции объекта на кинематическую модель (кривую вращения) с учетом всех неопределенностей.

Тогда логарифмическая функция правдоподобия имеет вид
%
\begin{align}
  \label{eq:L}\nonumber
  \mathcal{L} \equiv -\ln{L} &=
  \begin{aligned}[t]
    &-\sum_{j=1}^N \Biggl\{ -4 \ln{\sqrt{2 \pi}} - \ln{(\sigma_{V_r})_j} - \ln{(\sigma_{\mu_l'})_j} - \ln{(\sigma_{\mu_b})_j} - \ln{\sigma_{\varpi,j}} - {}\\
    &-\frac{[ V_{r,j} - V_{r,\text{mod}}(\varpi_{0,j}) ]^2}{2 (\sigma_{V_r})_j^2} - \frac{[ \mu_{l,j}' - \mu_{l,\text{mod}}'(\varpi_{0,j}) ]^2}{2 (\sigma_{\mu_l'})_j^2} - {}\\
    &-\frac{[ \mu_{b,j} - \mu_{b,\text{mod}}(\varpi_{0,j}) ]^2}{2 (\sigma_{\mu_b})_j^2} - \frac{( \varpi_j - \varpi_{0,j} )^2}{2 \sigma_{\varpi,j}^2} \Biggr\} = {}
  \end{aligned}\\
  \nonumber
  &= 4 N \ln{\sqrt{2 \pi}}
  \begin{aligned}[t]
    &+ \sum_{j=1}^N \left[ \ln{(\sigma_{V_r})_j} + \ln{(\sigma_{\mu_l'})_j} + \ln{(\sigma_{\mu_b})_j} + \ln{\sigma_{\varpi,j}} \right] + {}\\
    &+ \frac{1}{2} \sum_{j=1}^N \min_{\varpi_{0,j}} \left\{ \frac{[ V_{r,j} - V_{r,\text{mod}}(\varpi_{0,j}) ]^2}{(\sigma_{V_r})_j^2} + \frac{[ \mu_{l,j}' - \mu_{l,\text{mod}}'(\varpi_{0,j}) ]^2}{(\sigma_{\mu_l'})_j^2} + {} \right.\\
    &+ \left. \frac{[ \mu_{b,j} - \mu_{b,\text{mod}}(\varpi_{0,j}) ]^2}{(\sigma_{\mu_b})_j^2} + \frac{( \varpi_j - \varpi_{0,j} )^2}{\sigma_{\varpi,j}^2} \vphantom{\frac{[ \mu_{l,j}' - \mu_{l,\text{mod}}'(\varpi_{0,j}) ]^2}{(\sigma_{\mu_l'})_j^2}} \right\} = {}
  \end{aligned}\\
  &= \mathcal{L}^{(0)} + \mathcal{L}^{(1)}(\mathbf{a}),
\end{align}
%
где $ L^{(0)} = 4 N \ln{\sqrt{2 \pi}} + \sum_{j=1}^N \ln{\sigma_{\varpi,j}} = \text{const} $, $ \mathbf{a} = (R_0, \omega_0, A, \theta_2, \ldots, \theta_n, u_\odot, v_\odot, w_\odot, \sigma_R, \sigma_\theta, \sigma_Z) $ --- вектор параметров модели. Решение --- точечная оценка вектора $ \mathbf{a} $ --- для фиксированных модели и выборки дается минимизацией логарифмической функции правдоподобия:
%
\begin{equation}
  \label{eq:L_1}
  \mathcal{L}^{(1)}(\mathbf{a}) \rightarrow \min.
\end{equation}

Примем обозначения
%
\begin{align}
  \mathcal{L}_0^{(1)} &\equiv \min{\mathcal{L}^{(1)}(\mathbf{a})},\\
  \label{eq:L_c}
  \mathcal{L}_c^{(1)}(a_m) &\equiv \min_{a_m = \text{const}}{\mathcal{L}^{(1)}(\mathbf{a})}.
\end{align}
%
Последнюю функцию можно назвать профилем целевой функции для параметра $ a_m $. Тогда корни уравнения
%
\begin{equation}
  \label{eq:L_c_roots}
  \mathcal{L}_c^{(1)}(a_m) = \mathcal{L}_0^{(1)} + 1 / 2
\end{equation}
%
дают границы доверительных интервалов для оценки параметра $ a_m $ на доверительном уровне $ 1 \sigma $.

\hyperlink{toc}{\subsection{Уровень II. Оптимизация порядка модельной кривой вращения}}

В \cite{N.2003} предлагается следующая процедура определения для любой заданной выборки опорных объектов таких порядков разложения \eqref{eq:model} $ n \ge 1 $, которые обеспечивают достаточно адекватное представление кривой вращения по этим объектам, чтобы оценки $ R_0 $ получались систематически несмещенными. Назовем такие порядки допустимыми ($ \tilde{n}_\text{o} $).

По результатам решений \eqref{eq:L_1} для $ n = 1, 2, \ldots $ строятся зависимости $ \mathcal{L}_0^{(1)}(n) \equiv \min_\mathbf{a} \mathcal{L}^{(1)}(\mathbf{a}, n) $ и $ \sigma_\theta(n) $. Расчеты, выполненные в \cite{N.2003} и данной работе, показывают, что обычно после начального резкого падения дальнейшее уменьшение этих величин приостанавливается для нескольких значений $ n $. Этот эффект возникает благодаря достигнутому воспроизведению наиболее значимых деталей действительного закона $ \theta(R) $ модельными полиномами $ \eqref{eq:model} $: рост $ n $ не ведет к выявлению новой структуры в данных. Поэтому первоначально во множество допустимых порядков $ \{ \tilde{n}_\text{o} \} $ включаются последовательные значения $ n $ по правилу
%
\begin{equation}
  \label{eq:n_rule}
  \mathcal{L}_0^{(1)}(n) \approx \text{const}, \quad \sigma_\theta(n) \approx \text{const} \quad \forall \; n \in \{ \tilde{n}_\text{o} \}.
\end{equation}
%
Затем эти значения $ \tilde{n}_\text{o} $ строго ограничиваются сверху минимальным из порядков $ n $, при которых\npar

\begin{enumerate}[label={\arabic*)}]
  \item все коэффициенты $ \theta_i $ становятся незначимыми:
  \begin{equation}
    \sigma_{\theta_i} / \theta_i \gtrsim 0.5 \quad \forall \; 2 \le i \le n;
  \end{equation}

  \item значимость коэффициента $ \theta_n $ снижается до уровня $ 1 \sigma $:
  \begin{equation}
    \sigma_{\theta_n} / \theta_n \gtrsim 1;
  \end{equation}

  \item модель $ \Theta_n(R) $ \eqref{eq:model} оказывается явно нереалистичной на краях интервала $ R $.
\end{enumerate}

Последнее часто сопровождается возобновлением уменьшением значений $ L_0^{(1)} $ и $ \sigma_\theta $, поэтому излишне сложные модели отсекаются уже на стадии формального применение правила \eqref{eq:n_rule}. Таким образом, в число допустимых моделей (как правило, от одной до трех) попадают самые простые модели кривой вращения из возможных.

\hyperlink{toc}{\subsection{Уровень III. Исключение <<выбросов>>}}

Полученное для функции правдоподобия \eqref{eq:L} решение \eqref{eq:L_1} определяет для каждого объекта выборки четыре невязки:
%
\begin{equation}
  V_{r,j} - V_{r,\text{mod}}(\varpi_{0,j}), \quad \mu_{l,j}' - \mu_{l,\text{mod}}'(\varpi_{0,j}), \quad \mu_{b,j} - \mu_{b,\text{mod}}(\varpi_{0,j}), \quad \varpi_j - \varpi_{0,j}, \quad j = 1, 2, \ldots, N.
\end{equation}
%
По этим данным, полученным при фиксированном допустимом порядке $ \tilde{n}_\text{o} $, производится поиск и исключение объектов с избыточными невязками. Для одномерного случая алгоритм описан в \cite{N.2003, N.2012, R.2017}. Для многомерного случая простейший алгоритм состоит в применении одномерного алгоритма к относительным невязкам по каждой из компонент скорости. Тогда исключаются объекты, которые отбираются хотя бы по одной компоненте. По результатам поиска <<выбросов>> для множества допустимых порядков $ \{ \tilde{n}_\text{o} \} $ принимается решение о перечне объектов, исключаемых из выборки. На следующей итерации все вычисления по схемам уровня I и II повторяются для оставшейся выборки. Остановка происходит, когда на очередной итерации исключений больше не понадобится.

\hyperlink{toc}{\subsubsection{Одномерный метод исключения <<выбросов>>}}

Обычно отбрасывают объекты с невязками
%
\begin{equation}
  \label{eq:rel_discrepancy}
  \frac{|\delta_j|}{\sigma_j} > k = 3,
\end{equation}
%
где $ \sigma_j $ --- выборочная оценка стандарта для $j$-ого объекта, которая в нашем случае находится по формулам \eqref{eq:D_V_r}--\eqref{eq:D_mu_b}. Однако данный критерий трех сигм (действующий при $ N $ > 10) не учитывает того, что вероятность появления хотя бы одной невязки \eqref{eq:rel_discrepancy} растет с $ N $ и становится не малой уже при $ N $ порядка нескольких десятков. Можно выбирать $ k \sim 4 \div 5 $ таким образом, чтобы оно росло в зависимости от $ N $. Но этот вариант критерия \eqref{eq:rel_discrepancy} позволяет исключать только явные промахи и срабатывает довольно редко. Главное, при помощи него нельзя обнаружить отклонение $ f(\delta / \sigma) $ от нормального распределения, состоящее в наличии избытка объектов с $ |\delta_j| \sim 3 \sigma_j $.

Взамен, используется более гибкий алгоритм исключения объектов с большими невязками, учитывающий возможность подобных отклонений \cite{N.2003}:\npar

\begin{enumerate}
  \item Для данного объема выборки $ N $ находится значение $ \kappa $, которое удовлетворяет уравнению
  %
  \begin{equation}
    \left[ 1 - \psi(\kappa) \right] N = 1,
  \end{equation}
  %
  где $ \psi(z) $ --- интеграл вероятностей:
  %
  \begin{equation}
    \psi(z) = \sqrt{\frac{2}{\pi}} \int_0^z e^{-\frac{1}{2} t^2} dt.
  \end{equation}

  \item Находится число объектов $ L $ данной выборки, удовлетворяющих условию
  %
  \begin{equation}
    \label{eq:kappa_condition}
    \frac{|\delta_j|}{\sigma_j} > \kappa.
  \end{equation}
  %
  Математическое ожидание этого числа равно единице при нормальном распределении невязок. Большее число таких объектов может рассматриваться как избыточное с той или иной вероятностью.

  \item Если $ L > 1 $, то из дальнейшего рассмотрения исключаются $ L - L' $ объектов с наибольшими по модулю невязками, где $ L' \ge 1 $ --- параметр данного алгоритма.

  \item К оставшимся объектам, т.е., в частности, при $ L = 1 $, применяется критерий \eqref{eq:rel_discrepancy} с $ k $, зависящим от $ N $: исключаются объекты с невязками
  %
  \begin{equation}
    \frac{|\delta_j|}{\sigma_j} > k_\gamma(N),
  \end{equation}
  %
  где $ k_\gamma $ --- корень уравнения
  %
  \begin{equation}
    \label{eq:k_gamma}
    1 - \left[ \psi(k_\gamma) \right]^N = \gamma,
  \end{equation}
  %
  $ \gamma $ --- принятый уровень значимости. При малых $ \gamma $, т.е. при малых $ 1 - \psi(k_\gamma) $, вместо \eqref{eq:k_gamma} можно воспользоваться приближенным уравнением
  %
  \begin{equation}
    \left[ 1 - \psi(k_\gamma) \right] N = \gamma.
  \end{equation}
  %
  Данный пункт является страховочным на те случаи, когда имеется единственный и очень сильный промах (при $ L = 1 $ пункт 3 обходится) или когда при больших $ N $ имеются только несколько таких промахов, а остальные невязки следуют нормальному закону (тогда оставшиеся в выборке $ L'$ объектов удовлетворяют \eqref{eq:k_gamma}). В данной работе принят уровень значимости $ \gamma = 0.05 $.
\end{enumerate}

Для приблизительной оценки вероятности $ \mathcal{P}(L) $ случайного появления $ L $ невязок, удовлетворяющих условию $ \eqref{eq:kappa_condition} $, можно воспользоваться распределением Пуассона, которое в этом случае имеет вид:
%
\begin{equation}
  \mathcal{P}(L) = \frac{e^{-1}}{L!}.
\end{equation}
%
Тогда
%
\begin{align}
  \mathcal{P}(L \ge 2) &\approx 0.264,\\
  \mathcal{P}(L \ge 3) &\approx 0.080,\\
  \mathcal{P}(L \ge 4) &\approx 0.019.
\end{align}
%
Исходя из этих величин, избыточным можно считать число $ L = 3 $ или $ 4 $, т.е. принять $ L' = 2 $ или $ 3 $, соответственно. Выбор $ L' $ зависит от характера задачи. Для получения несмещенных оценок недисперсионных параметров модели следует выбрать $ L' = 1 $. Даже в этом случае $ \approx 3/4 $ исключаемых объектов действительно являются аномальными. Однако для оценки дисперсий скоростей важно не слишком урезать крылья распределения по скоростям, иначе дисперсии получатся систематически заниженными. Потому для оценки природных дисперсий следует брать $ L' = 3 $. Действовать надо, однако, в обратном порядке: сначала решить задачу с $ L' = 3 $. Затем зафиксировать полученные (несмещенные) дисперсии и решить задачу относительно остальных параметров, но уже с $ L' = 1 $.

\hyperlink{toc}{\subsubsection{Четырехмерный метод исключения <<выбросов>>}}

Альтернативой применению одномерного алгоритма к каждому из четырех векторов относительных невязок (исключаются объекты, которые отбираются хотя бы по одной компоненте) является рассмотрение задачи о вероятности получить для объекта по случайности величину некоторой статистики, характеризующей всю комбинацию измеренных для данного объекта четырех относительных невязок, равной или большей найденной для принятой модели. Если решение близко к истинному вектору параметров, то можно предположить, что каждая их этих относительных невязок распределена по нормальному закону с нулевым математическим ожиданием и единичной дисперсией. Тогда указанной статистикой может служить случайная величина хи-квадрат с четырьмя степенями свободы, $ \chi_4^2 $.

В общем случае для $ n $ степеней свободы ($ n \ge 1 $) плотность вероятности случайной величины $ \chi_n^2 $ имеет вид
%
\begin{equation}
  \label{eq:f_n}
  f_n(z) = \frac{1}{2^{n/2} \, \Gamma(n / 2)} z^{n / 2 - 1} e^{-z / 2},
\end{equation}
%
где $ z $ --- значение $ \chi_n^2 $. При $ n = 4 $ распределение \eqref{eq:f_n} приобретает более простую форму:
%
\begin{equation}
  f_4(z) = \frac{1}{4 \, \Gamma(2)} z e^{-z / 2} = \frac{1}{4} z e^{-z / 2}.
\end{equation}
%
Здесь использовано равенство $ \Gamma(n) = (n - 1)! \;\, \forall \; n \in \mathbb{Z}, \; n > 0 $. Найдем интегральное распределение $ \chi_4^2 $:
%
\begin{equation}
  F_4(z) \stackrel{\text{def}}{=} \mathcal{P}(\chi_4^2 < z) = \int_0^z f_4(\zeta) \, d\zeta = \frac{1}{4} \int_0^z \zeta e^{-\zeta / 2} \, d\zeta.
\end{equation}
%
После замены переменной $ u = \zeta / 2 $ получаем:
%
\begin{equation}
  F_4(z) = \frac{1}{4} \int_0^{z / 2} 2 u e^{-u} 2 \, du = \int_0^{z / 2} u e^{-u} \, du = \left[ -e^{-u} (u + 1) \right]_0^{z / 2} = 1 - e^{-z / 2} \left( \frac{z}{2} + 1 \right).
\end{equation}
%
То есть, в отличие от общего случая, интегральное распределение $ \chi_4^2 $ выражается в явном виде. Тогда дополнение функции $ F_4(z) $ до единицы (вероятность превышения $ \chi_4^2 $ величины $ z $)
%
\begin{equation}
  1 - F_4(z) = \mathcal{P}(\chi_4^2 > z) = e^{-z / 2} \left( \frac{1}{2} + 1 \right).
\end{equation}

Применительно к данной задаче для $j$-го объекта значение $ \chi_4^2 $ находится по формуле
%
\begin{equation}
  z_j = \frac{[ V_{r,j} - V_{r,\text{mod}}(\varpi_{0,j}) ]^2}{(\sigma_{V_r})_j^2} + \frac{[ \mu_{l,j}' - \mu_{l,\text{mod}}'(\varpi_{0,j}) ]^2}{(\sigma_{\mu_l'})_j^2} + \frac{[ \mu_{b,j} - \mu_{b,\text{mod}}(\varpi_{0,j}) ]^2}{(\sigma_{\mu_b})_j^2} + \frac{( \varpi_j - \varpi_{0,j} )^2}{\sigma_{\varpi,j}^2}.
\end{equation}
%
В обобщенном алгоритме функция интегрального распределения $ F_4(z) $ случайной величины $ \chi_4^2 $ играет ту же роль, что и интеграл вероятности $ \psi(z) $ в одномерном алгоритме. Соответственно, алгоритм применения метода аналогичен пунктам 1--4, описанным в предыдущем подразделе.

\hyperlink{toc}{\subsubsection{Трехмерный метод исключения <<выбросов>>}}

В случае, если неопределенность параллаксов игнорируется, для многомерного метода следует использовать статистику $ \chi_3^2 $. При $ n = 3 $ распределение \eqref{eq:f_n} имеет вид
%
\begin{equation}
  f_3(z) = \frac{1}{2^{3/2} \Gamma(3/2)} z^{3/2 - 1} e^{-z / 2}.
\end{equation}
%
Тогда интегральное распределение $ \chi_3^2 $ находится как
%
\begin{equation}
  F_3(z) \stackrel{\text{def}}{=} \mathcal{P}(\chi_3^2 < z) = \int_0^z f_4(\zeta) \, d\zeta = 1 - \frac{2 \Gamma(\frac{3}{2}, \frac{z}{2})}{\sqrt{\pi}},
\end{equation}
%
где $ \Gamma(a, z) $ --- верхняя неполная гамма-функция, определяемая формулой
%
\begin{equation}
  \Gamma(a, z) = \int_z^\infty e^{-t} t^{a - 1} \, dt.
\end{equation}
%
Значение $ \chi_3^2 $ для $j$-го объекта в данной задаче находится по формуле
%
\begin{equation}
  z_j = \frac{[ V_{r,j} - V_{r,\text{mod}}(\varpi_j) ]^2}{(\sigma_{V_r})_j^2} + \frac{[ \mu_{l,j}' - \mu_{l,\text{mod}}'(\varpi_j) ]^2}{(\sigma_{\mu_l'})_j^2} + \frac{[ \mu_{b,j} - \mu_{b,\text{mod}}(\varpi_j) ]^2}{(\sigma_{\mu_b})_j^2}.
\end{equation}
%
В остальном применение метода аналогично описанному в предыдущем подразделе.

\hyperlink{toc}{\subsection{Визуализация результатов}}

В принятой параметризации \eqref{eq:A}
%
\begin{equation}
  \theta_1 = \omega_0 - 2 A.
\end{equation}
%
Тогда, принимая во внимание, что $ \theta_0 = \omega_0 R_0 $, модельная кривая вращения \eqref{eq:model} следующим образом выражается через найденные параметры:
%
\begin{align}
  \Theta_n(R) &= \theta_0 + \theta_1 \Delta R + \sum_{i=2}^n \frac{\theta_i}{i!} (\Delta R)^i = {}\\
  &= \omega_0 R_0 + (\omega_0 - 2 A) (R - R_0) + \sum_{i=2}^n \frac{\theta_i}{i!} (\Delta R)^i = {}\\
  &= \omega_0 R - 2 A \Delta R + \sum_{i=2}^n \frac{\theta_i}{i!} (\Delta R)^i.
\end{align}
%
Модельная кривая вращения сопоставляется с наблюдательными данными $ \theta_j(R_j) $ на одном рисунке. Наблюдательные неопределенности определения азимутальной скорости, исходящие из неопределенностей измерений лучевых скоростей и собственных движений, определяются по формуле распространения ошибок:
%
\begin{equation}
  \sigma_{\theta,\text{vel}}^2 = \left( \frac{\partial \theta}{\partial V_r} \right)^2 \sigma_{V_r}^2 + \left( \frac{\partial \theta}{\partial \mu_x} \right)^2 \sigma_{\mu_x}^2 + \left( \frac{\partial \theta}{\partial \mu_y} \right)^2 \sigma_{\mu_y}^2
\end{equation}
%
Наблюдательные неопределенности, исходящие из неопределенностей измерений параллакса (влияющие как на азимутальную скорость, так и на галактоосевое расстояние, вследствие чего изображаемые на графике ломаными линиями), определяются путем вычисления кривой вращения для крайних значений параллакса $ \varpi - \sigma_\varpi^{-} $ и $ \varpi + \sigma_\varpi^{+} $.

\hyperlink{toc}{\subsection{Получение оценок средних ошибок параллаксов}}

Решение проблемы оптимизации суммы квадратов относительных невязок даёт нам набор приведенных параллаксов $ \varpi_{0,j} $. Мы можем обработать набор значений $ x_j = \varpi_{0,j} - \varpi_j $ как ряд неравноточных измерений с весами $ p_i = 1 / \sigma_j^2 $. При использовании классического метода теории ошибок удобно применять рабочие формулы \cite{A.1968}
%
\begin{align}
  p &= \sum_{j=1}^N p_j,\\
  \overline{x} &= \frac{1}{p} \left( \sum_{j=1}^N p_j (x_j - a) \right) + a,\\
  \sigma &= \sqrt{ \frac{1}{N - 1} \left[ \left( \sum_{j=1}^N p_j (x_j - a)^2 \right) - p (\overline{x} - a)^2 \right] },\\
  \sigma_{\overline{x}} &= \frac{\sigma}{\sqrt{p}},
\end{align}
%
где $ \overline{x} $ --- среднее взвешенное выборки, $ \sigma $ --- средняя ошибка единицы веса, $ \sigma_{\overline{x}} $ --- средняя ошибка среднего взвешенного. $ a $ выбирается круглым числом, близким к $ \overline{x} $, --- здесь мы полагаем его равным нулю. В силу определения $ x_j $ считаем, что $ \overline{x} = \Delta\varpi $ есть средняя систематическая ошибка параллаксов, а $ \sigma_{\overline{x}} $ --- её ошибка. Имеет также смысл определить взвешенный стандарт выборки
%
\begin{equation}
  \sigma' = \sqrt{\frac{1}{p} \sum_{j=1}^N p_j (x_j - \overline{x})^2}.
\end{equation}
%
Он имеет смысл средней случайной ошибки параллаксов в выборке.

\hyperlink{toc}{\section{Применение метода к мазерам}}

\hyperlink{toc}{\subsection{Наблюдательные данные}}

Наш взгляд на Млечный Путь изнутри не позволяет легко раскрыть его свойства. Солнце находится недалеко от срединной плоскости Галактики, в результате чего на небе накладываются несколько структур на разных расстояниях. Непосредственное картографирование спиральной структуры Млечного Пути оказалось сложной задачей, поскольку расстояния очень велики, а межзвездное поглощение пыли блокирует большую часть галактической плоскости в оптических длинах волн. Таким образом, Gaia, даже с точностью параллакса $ \pm 0.02 $ мсд, не сможет свободно нанести на карту галактическую плоскость. Однако радиоинтерферометрия со сверхдлинной базой (РСДБ) не зависит от межзвездного поглощения и может обнаруживать, в частности, молекулярные мазеры, связанные с массивными молодыми звездами, которые лучше всего прослеживают спиральную структуру в галактиках. Текущая точность параллакса для РСДБ позволяет измерять расстояния на большей части Млечного Пути. В рамках обзора BeSSeL \cite{BeSSeL} и проекта VERA \cite{VERA.2020} в настоящее время измерено около 200 параллаксов мазеров с точностью обычно около $ \pm 0.02 $ мсд. В работе Санна и др. (2017) \cite{S.2017} был измерен параллакс мазера $ 0.049 \pm 0.006 $ мсд, поместивший его молодую массивную звезду на расстояние 20 кпк, т.е. примерно на 12 кпк дальше от центра Галактики.

Для данной работы был составлен новый каталог мазерных источников. Каталог содержит имена объектов; их экваториальные координаты $ (\alpha, \delta) $; тригонометрические параллаксы, $ \varpi $, с их неопределенностями; лучевые скорости относительно Местного стандарта покоя, $ V_\text{LSR} $, с их неопределенностями; собственные движения в экваториальных координатах, $ \mu_x = \mu_\alpha \cos{\delta} $ и $ \mu_y = \mu_\delta $, с их неопределенностями; тип объекта; маркер исходного каталога; сноски к соответствующим статьям. Были объединены каталоги VERA (2020) \cite{VERA.2020} (99 объектов) и Рид и др. (2019) \cite{R.2019} (199 объектов), а также добавлены новые объекты и данные (13 объектов). После отождествления одинаковых объектов между источниками (выбирались в порядке приоритета либо новые данные, либо данные из \cite{R.2019}) и исключения объектов с неполным набором данных итоговой объем каталога составил 276 объектов. По типам мазеров в итоговый вариант входят: области образования звезд с эволюционно молодыми центральными звездами (star-forming regions, SFRs) (36 объектов), включая маломассивные (LMSFRs) (4 объекта); области образования массивных звезд (Рид и др. включают сюда красные сверхгиганты; high-mass star-forming regions, HMSFRs) (207 объектов); звезды асимптотической ветви гигантов (Asymptotic Giants Branch, AGB) (33 объекта).

Фрагмент нового каталога представлен в \autoref{table:catalog}. Распределения объектов в пространстве (в декартовой гелиоцентрической галактической системе координат) для всего каталога и для выборки HMSFRs представлены на \autoref{fig:all_xyz} и \autoref{fig:hmsfrs_xyz}, соответственно, а кривые вращения --- на \autoref{fig:all_rotation_curves} и \autoref{fig:hmsfrs_rotation_curves}.

Поскольку новый каталог представляет собой смесь различных источников, выборка, включающая в себя все объекты, не является однородной. Поэтому для достижения цели работы были выбраны две меньшие выборки: одна, включающая только объекты типа HMSFR (207 объектов); и одна, являющаяся подвыборкой первой, включающая в себя только те объекты типа HMSFR, что расположены вблизи солнечного круга (отбор по $ R $ в пределах 3-х кпк от $ R_0 = 8.15 $ кпк) (139 объектов). Объекты типа HMSFR выбраны как превалирующие в полном каталоге, с объемом выборки, достаточным для получения модели, способной проявить значимые детали закона вращения (например, <<провал>> после солнечного круга). Вторая выборка выбрана с целью проверить, достаточно ли линейной модели для описания закона вращения в окрестности солнечного круга.

Выбора одного типа мазеров, однако, недостаточно для достижения однородности выборок. Необходимо также иметь в виду, что в \cite{R.2019} к измерительной неопределенности скоростей добавляют (в квадратах) член, связанный с неопределенностью переноса движения мазеров к движению центральной звезды. Обычно этот член составлял $ \pm 5 $ км/с для метанольных мазеров и $ \pm 10 $ км/с для мазеров воды. Последняя величина была использована в данной работе при решении задач оптимизации. Ссылаясь на формулы из первого раздела, это означает добавление $ 10^2 $ км$^2$/c$^2$ к измерительной дисперсии $ (\tilde{\sigma}_{V_{\text{LSR}}})_j^2 = (\tilde{\sigma}_{V_r})_j^2 $, используемой в \eqref{eq:D_V_r}, и члена, пересчитанного в зависимости от параллакса по аналогичным \eqref{eq:sigma_mu_l'_mu_b} формулам, к измерительным дисперсиям собственных движений в экваториальных координатах $ (\tilde{\sigma}_{\mu_x})_j^2 $ и $ (\tilde{\sigma}_{\mu_y})_j^2 $, используемым при вычислении измерительных дисперсий собственных движений в галактических координатах $ (\tilde{\sigma}_{\mu_l'})_j^2 $ \eqref{eq:tilde_sigma_mu_l} и $ (\tilde{\sigma}_{\mu_b})_j^2 $ \eqref{eq:tilde_sigma_mu_b}.

\hyperlink{toc}{\subsection{Приведенные параллаксы}}

Решение основной задачи заключается в определении фундаментальных параметров Галактики путем оптимизации логарифмической функции правдоподобия \eqref{eq:L} (назовем эту задачу оптимизации внешней), однако главной составляющей этой функции является ещё одна задача оптимизации --- задача уточнения значений параллаксов (назовем её внутренней). Набор уточненных значений параллаксов (получаемый для каждой модели) позволяет оценить статистические свойства распределения каталожных параллаксов и сделать выводы как и о качестве какого-то конкретного из полученных решений, так и о корректности применения метода кинематической коррекции измерений параллаксов методом статистических параллаксов в целом. Помимо этого, сами такие наборы данных могут иметь прикладное значение, а потому каждый был выделен в отдельный каталог (см. пример в \autoref{table:parallaxes}).

\input{tables/parallaxes.tex}

\clearpage

\input{tables/catalog.tex}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 1.80cm 0},clip]{All/objects/Plots by type/XY}}}
  \subfloat{{\includegraphics[trim={0.51cm 0.5cm 0 0},clip]{All/objects/Plots by type/XY (errors)}}}\\
  \makebox[0.97\textwidth][l]{\subfloat{{\includegraphics[trim={0 0 1.80cm 0},clip]{All/objects/Plots by type/XZ}}}
  \subfloat{{\includegraphics[trim={0.60cm 0 0 0},clip]{All/objects/Plots by type/XZ (errors)}}}}
  \caption{Распределения объектов всего каталога в гелиоцентрической галактической системе координат. Положительное направление оси X соответствует направлению на центр Галактики, ось Y --- направлению $ l = 90\degree $, ось Z --- направлению $ b = 90\degree$.}
  \label{fig:all_xyz}
\end{figure}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 1.56cm 0},clip]{HMSFRs/objects/XY}}}
  \subfloat{{\includegraphics[trim={0.51cm 0.5cm 0 0},clip]{HMSFRs/objects/XY (errors)}}}\\
  \makebox[0.952\textwidth][l]{\subfloat{{\includegraphics[trim={0 0 1.56cm 0},clip]{HMSFRs/objects/XZ}}}
  \subfloat{{\includegraphics[trim={0.60cm 0 0 0},clip]{HMSFRs/objects/XZ (errors)}}}}
  \caption{Распределения объектов выборки HMSFRs в гелиоцентрической галактической системе координат. Положительное направление оси X соответствует направлению на центр Галактики, ось Y --- направлению $ l = 90\degree $, ось Z --- направлению $ b = 90\degree$.}
  \label{fig:hmsfrs_xyz}
\end{figure}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{All/objects/Plots by type/Rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{All/objects/Plots by type/Rotation curve (errors)}}}
  \caption{Кривая вращения (цветом указан тип объекта) для всего каталога, вычисленная при $ R_0 = 8.15 $ кпк, $ u_\odot = 10.7 $ км/с и $ \theta_\odot = 247 $ км/с. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:all_rotation_curves}
\end{figure}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{All/objects/Plots by source/Rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{All/objects/Plots by source/Rotation curve (errors)}}}
  \caption{Кривая вращения (цветом указан источник объектов) для всего каталога, вычисленная при $ R_0 = 8.15 $ кпк, $ u_\odot = 10.7 $ км/с и $ \theta_\odot = 247 $ км/с. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:hmsfrs_rotation_curves}
\end{figure}

\clearpage

\hyperlink{toc}{\subsection{Кратные локальные минимумы внутренней целевой функции}}

Значимой проблемой поиска минимума внешней целевой функции $ \mathcal{L}^{(1)} $ \eqref{eq:L} является наличие для некоторых объектов нескольких (как правило, двух, а иногда и трёх) локальных минимумов внутренней целевой функции (суммы квадратов относительных невязок). Использование методов локальной оптимизации без учета этого факта может привести к схождению алгоритма к разным значениям приведенного параллакса $ \varpi_{0,j} $, что выражается в виде <<скачков>> на профилях внешней целевой функции. Примеры профилей внутренней целевой функции приведены на \autoref{fig:inner_profiles}.

Оптимизация приведенного параллакса фактически комбинирует методы оценки расстояния способом статистического параллакса и кинематического (по кривой вращения). Как видно на \autoref{fig:odd_objects}, подавляющее число проблемных объектов расположены в пределах солнечного круга. Возможной причиной наличия нескольких локальных минимумов в таком случае может быть движение по лучу зрения вблизи тангенциальных точек, что дает две точки с одинаковой модельной лучевой скоростью (при равных $ R $ и $ l $). Это хорошо известная двойственность кинематических расстояний во внутренней части Галактики.

Для выборки мазеров вблизи солнечного круга (при $ n = 1 $) число этих объектов составило 17 (из 134 после исключений), для выборки HMSFRs (при $ n = 3 $) --- 95 (из 193 после исключений). То есть в последнем случае примерно половина объектов способна категорически повлиять на результат, если их учет при реализации метода неверен или отсутствует.

В данной работе эта проблема обходится путем поиска глобального минимума внутренней целевой функции с помощью подпромежутков сначала в пределах $ \pm 3 \sigma $ от наблюдаемого параллакса, а затем, если ни одного минимума не было найдено, последовательно в б\'{о}льших пределах $ \pm 6 \sigma $ и $ \pm 9 \sigma $. Если бы в пределах $ \pm 9 \sigma $ локальный минимум не был бы найден (что, однако, не случилось ни разу), приведенное значение параллакса было бы положено равным нулю, что неизбежно привело бы к исключению данного объекта в процессе проверки невязок.

Стоит отметить, что поиск глобального минимума в задаче внешней оптимизации успешен лишь в случаях, когда сама модель адекватна для описания закона вращения. Это связано с тесной связью между алгоритмами внутренней и внешней оптимизации: оценки параметров на внешней оптимизации влияют на вид профиля внутренней целевой функции, а определяемое по этому профилю значение приведенного параллакса в свою очередь влияет на сходимость алгоритма внешней оптимизации. Любое несоответствие модели реальным данным (заключающееся, как правило, в неудачном выборе $ n $, а также в наличии в выборке объектов с большими невязками) влияет на гладкость профиля целевой функции, что в свою очередь влияет на процесс определения доверительных интервалов параметров. Однако эти же дефекты можно использовать для оценки допустимых порядков модели.

В силу описанного и того факта, что вычисление формальных ошибок параметров является ресурсоемким процессом, уровни I--III алгоритма были выполнены итеративным методом. Сначала выбирался оптимальный порядок $ n_\text{o} $, соответствующая которому модель использовалась для поиска и исключения <<выбросов>>, согласно уровню III. Далее, полученные результаты анализировались по критериям, описанным в уровне II, и выбирался следующий оптимальный порядок $ n_\text{o} $, для которого весь алгоритм повторялся вновь. Так до тех пор, пока истинный оптимальный порядок (или набор допустимых) не найдется (оказалось достаточно двух-трех итераций).

\clearpage

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip]{Near the solar circle/n = 1/Inner profiles/42}}}
  \subfloat{{\includegraphics[trim={0.51cm 0.5cm 0 0},clip]{HMSFRs/n = 3/Inner profiles/29}}}\\
  \makebox[0.832\textwidth][l]{\subfloat{{\includegraphics{Near the solar circle/n = 1/Inner profiles/37}}}
  \subfloat{{\includegraphics[trim={0.51cm 0 0 0},clip]{HMSFRs/n = 3/Inner profiles/54}}}}
  \caption{Профили внутренней целевой функции (суммы квадратов относительных невязок), построенные по итоговым параметрам модели для объектов G037.42+01.51 (выборка мазеров вблизи солнечного круга, $ n = 1$, слева сверху), G012.68-00.18 (полная выборка HMSFRs, $ n = 3 $, справа сверху), G035.02+00.34 (выборка мазеров вблизи солнечного круга, $ n = 1 $, слева снизу) и G023.38+00.18 (полная выборка HMSFRs, $ n = 3 $, справа снизу). Желтой линией отмечено номинальное (указанное в каталоге) значение параллакса, зеленой --- приведенное.}
  \label{fig:inner_profiles}
\end{figure}
%
\begin{figure}
  \centering
  \subfloat{{\includegraphics[trim={0 0 1.56cm 0},clip]{HMSFRs/n = 3/Odd objects (XY)}}}
  \subfloat{{\includegraphics[trim={0.51cm 0 0 0},clip]{HMSFRs/n = 3/Odd objects (XY) (errors)}}}
  \caption{Распределение объектов с несколькими локальными минимумами на профилях внутренней целевой функции (выборка HMSFRs, $ n = 3 $, 95 объектов) в гелиоцентрической галактической системе координат. Положительное направление оси X соответствует направлению на центр Галактики, ось Y --- направлению $ l = 90\degree $, ось Z --- направлению $ b = 90\degree$.}
  \label{fig:odd_objects}
\end{figure}

\clearpage

\hyperlink{toc}{\subsection{Результаты}}

В последующих таблицах приведены результаты моделирования, представляющие собой набор основных параметров, производных параметров и (там, где уместно) статистик для приведенных параллаксов. Также указаны объемы выборки до и после выполнения процедур поиска и исключения <<выбросов>> при $ L' = 3 $ и $ L' = 1 $. Оценки параметров эллипсоида скоростей получены при объеме выборки $ N_{L' = 3} $, а все остальные --- при $ N_{L' = 1} $. Жирным выделен оптимальный порядок, выбранный по совокупности данных об относительных ошибках коэффициентов $ \theta_i, \, i \ge 2 $, графикам зависимостей $ L^{(1)}(n) $ и $ \sigma_\theta(n) $, а также по виду кривой вращения.

Для всех параметров приведены ошибки на уровне $ 1 \sigma $. Нули в ошибках для некоторых параметров означают, что алгоритм поиска корня уравнения \eqref{eq:L_c_roots} не смог найти соответствующую (левую или правую) границу интервала поиска, при котором функция \eqref{eq:L_c} меняет знак. Это по сути означает негладкость окрестности найденной оценки (и, как следует полагать, неверность оценки в целом). Причина тому --- неудачный выбор порядка модели, влияющий на гладкость профилей внутренней целевой функции.

Начальные значения параметров для всех моделей (за исключением вариантов для получения самосогласованной выборки) полагались одинаковыми. Их значения приведены в \autoref{table:params_initial}.

\begin{table}[H]
  \centering
  \caption{Начальные значения основных параметров для всех моделей}
  \aboverulesep=0ex
  \belowrulesep=0ex
  \renewcommand{\arraystretch}{1.25}
  \renewcommand\cellset{\renewcommand{\arraystretch}{0.7}}
  \begin{tabular}{cccccccccc}
    \toprule
    $ R_0 $ & $ \omega_0 $ & $ A $ & $ u_\odot $ & $ v_\odot $ & $ w_\odot $ & $ \sigma_R $ & $ \sigma_\theta $ & $ \sigma_Z $ & $ \theta_i, \; i \ge 2 $ \\
    (кпк) & \multicolumn{2}{c}{(км/с/кпк)} & \multicolumn{3}{c}{(км/с)} & \multicolumn{3}{c}{(км/с)} & (км/с/кпк$^i$) \\
    \midrule
    $ 8.15 $ & $ 28.0 $ & $ 17.0 $ & $ 10.7 $ & $ 19.0 $ & $ 7.7 $ & $ 12.0 $ & $ 6.0 $ & $ 3.0 $ & $ 0.0 $ \\
    \bottomrule
  \end{tabular}
  \label{table:params_initial}
\end{table}

По результатам оптимизации были также вычислены производные от параметров модели характеристики: $ \theta_0 = R_0 \omega_0 $, $ \theta_1 = \omega_0 - 2 A $, $ \theta_\odot = \theta_0 + V_\odot $, $ \omega_\odot = \theta_\odot / R_0 = \omega_0 + V_\odot / R_0 $. Последняя характеристика является наиболее важной, поскольку она является универсальной для всех подсистем (в отличие от $ \omega_0 $, которая для каждой подсистемы своя). И в отличие от $ \theta_\odot $, $ \omega_\odot $ слабо зависит от $ R_0 $ и шкалы расстояний. Для определения ошибок каждого производного параметра была временно изменена параметризация при нахождении значений функции $ L_c^{(1)}(a_m) $ \eqref{eq:L_c} и корней уравнения \eqref{eq:L_c_roots}. Например, для определения ошибок $ \omega_\odot $ значение этой величины фиксировалось, а по ней считалась $ \omega_0 = \omega_\odot - V_\odot / R_0 $. При этом все параметры, кроме $ \omega_0 $, оптимизировались как обычно.

Результаты для выборки мазеров вблизи солнечного круга представлены в \autoref{table:solar}, кривые вращения --- на \autoref{fig:solar}. Был определен оптимальным порядок $ n = 1 $. По полученной оценке $ R_0 $ была образована новая выборка вблизи солнечного круга, меньшая по объему на один объект, и при новом начальном приближении этого параметра по ней была получена ещё одна оценка $ R_0 $. При повторном образовании выборки изменений в объеме не произошло, а итоговая оценка совпала с новой начальной (см. результаты по самосогласованной выборке в \autoref{table:solar_sc}, кривые вращения --- на \autoref{fig:solar_sc}).

Результаты для полной выборки HMSFRs представлены в \autoref{table:hmsfrs}, кривые вращения --- на \autoref{fig:hmsfrs}. Был определен оптимальным порядок $ n = 3 $. Статистические ошибки параметров оказались ниже, чем для выборки мазеров вблизи солнечного круга. Для данной выборки также представлены профили целевой функции (\autoref{fig:profiles_hmsfrs}) и график соотношения исходных и приведенных параллаксов (\autoref{fig:parallaxes}).

Для обеих полных выборок также представлены графики зависимостей величин $ L^{(1)}(n) $ и $ \sigma_\theta(n) $ (\autoref{fig:n_plots}), подтверждающие выборы оптимальных порядков. На этих графиках можно увидеть как спад той или иной величины временно останавливается после одного из порядков (наблюдается <<плато>>), перед тем как вновь начать изменяться вследствие переобученности модели.

Во многих работах (в том числе и в \cite{R.2019}) неопределенность параллаксов не учитывается. Для демонстрации эффекта игнорирования этих неопределенностей были также получены результаты с отключенной внутренней оптимизацией для полной выборки HMSFRs (см. \autoref{table:hmsfrs_di}). По оптимальной выборке HMSFRs (полученной из полной выборки HMSFRs после исключения выбросов, $ N = 193 $) алгоритм был пропущен ещё раз, но уже с отключенными внутренней оптимизацией и проверками на выбросы (см. \autoref{table:hmsfrs_optimal}).

\clearpage

\input{tables/solar.tex}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{Near the solar circle/n = 1/Fitted rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{Near the solar circle/n = 1/Fitted rotation curve (errors)}}}
  \caption{Кривая вращения для оптимальной модели, полученная по мазерам вблизи солнечного круга. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:solar}
\end{figure}

\input{tables/solar_sc.tex}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{Near the solar circle (self-consistency check, iter 2)/n = 1/Fitted rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{Near the solar circle (self-consistency check, iter 2)/n = 1/Fitted rotation curve (errors)}}}
  \caption{Кривая вращения для оптимальной модели, полученная по мазерам вблизи солнечного круга по самосогласованной выборке. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:solar_sc}
\end{figure}

\input{tables/hmsfrs.tex}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{HMSFRs/n = 3/Fitted rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{HMSFRs/n = 3/Fitted rotation curve (errors)}}}
  \caption{Кривая вращения для оптимальной модели, полученная по выборке HMSFRs. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:hmsfrs}
\end{figure}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[scale=1.1]{HMSFRs/n = 3/Conditional profile of R_0}}}
  \subfloat{{\includegraphics[scale=1.1]{HMSFRs/n = 3/Conditional profile of omega_0}}}\\
  \subfloat{{\includegraphics[scale=1.1]{HMSFRs/n = 3/Conditional profile of A}}}
  \subfloat{{\includegraphics[scale=1.1]{HMSFRs/n = 3/Conditional profile of theta_2}}}\\
  \subfloat{{\includegraphics[scale=1.1]{HMSFRs/n = 3/Conditional profile of theta_3}}}
  \caption{Профили целевой функции для некоторых параметров модели, построенные при одном фиксированном параметре (на каждом рисунке он указан в подписи к оси абсцисс) и остальных свободных (выборка HMSFRs, $ n = 3 $).}
  \label{fig:profiles_hmsfrs}
\end{figure}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.75]{HMSFRs/n = 3/Parallaxes}}}\\
  \subfloat{{\includegraphics[scale=1.75]{HMSFRs/n = 3/Parallaxes (under 1 mas)}}}
  \caption{Соотношение исходных и приведенных параллаксов (выборка HMSFRs, $ n = 3$). На график нанесена биссектриса (прямая $ y = x $ серого цвета), а также набор отстоящих от неё по вертикали линий: средняя систематическая ошибка параллаксов $ \overline{x} = \Delta\varpi $ (желтая линия, линия модели зависимости) и её ошибка $ \sigma_{\overline{x}} $ (зеленые линии, показывающие доверительную область модели), а также взвешенный стандарт выборки $ \sigma' $ (красные линии, показывающие средний разброс).}
  \label{fig:parallaxes}
\end{figure}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.15]{Near the solar circle/L_1}}}
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.15]{Near the solar circle/sigma_theta}}}\\
  \subfloat{{\includegraphics[scale=1.15]{HMSFRs/L_1}}}
  \subfloat{{\includegraphics[scale=1.15]{HMSFRs/sigma_theta}}}
  \caption{Зависимости значений целевой функции $ \mathcal{L}^{(1)} $ и азимутальной компоненты эллипсоида скоростей $ \sigma_\theta $ от порядка модели для мазеров вблизи солнечного круга (сверху) и выборки HMSFRs (снизу).}
  \label{fig:n_plots}
\end{figure}

\input{tables/solar_di.tex}

\input{tables/hmsfrs_di.tex}

\begin{figure}[p!]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{HMSFRs (disabled inner optimization)/n = 3/Fitted rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{HMSFRs (disabled inner optimization)/n = 3/Fitted rotation curve (errors)}}}
  \caption{Кривая вращения для модели допустимого порядка $ n = 3 $, полученная по выборке HMSFRs с отключенной внутренней оптимизацией. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:rotation_curves_hmsfrs_di_n_3}
\end{figure}

\begin{figure}[!p]
  \centering
  \subfloat{{\includegraphics[trim={0 0.5cm 0 0},clip,scale=1.81]{HMSFRs (disabled inner optimization)/n = 4/Fitted rotation curve}}}\\
  \subfloat{{\includegraphics[scale=1.81]{HMSFRs (disabled inner optimization)/n = 4/Fitted rotation curve (errors)}}}
  \caption{Кривая вращения для модели допустимого порядка $ n = 4 $, полученная по выборке HMSFRs с отключенной внутренней оптимизацией. Скорректированные неопределенности скоростей показаны в виде дополнительных баров синего цвета.}
  \label{fig:rotation_curves_hmsfrs_di_n_4}
\end{figure}

\input{tables/hmsfrs_optimal.tex}

\clearpage

\hyperlink{toc}{\subsection{Обсуждение результатов}}

По полным выборкам (\autoref{table:solar}, \autoref{table:hmsfrs}) оптимальные порядки для мазеров вблизи солнечного круга и выборки HMSFRs определены как 1 и 3, соответственно. Результаты между выборками близки по сопоставимым параметрам, но для выборки HMSFRs они точнее. Профили целевой функции (\autoref{fig:profiles_hmsfrs}) для оптимальных порядков в основном гладкие, абсолютные ошибки параметров определяются точно, а относительные --- малы по величине. <<Провал>> после солнечного круга на кривой вращения подтверждается значимым отличием от нуля величины $ \theta_1 $ (и по полной выборке, и по мазерам вблизи солнечного круга). Зависимости $ L_1^{(1)}(n) $ и $ \sigma_\theta(n) $ подтверждают выбор оптимальных порядков.

Выборка для мазеров вблизи солнечного круга была доведена до самосогласования путем повторных образований выборки с заменой начального значения $ R_0 $ на полученное при оптимизации (\autoref{table:solar_sc}).

Для вариантов с отключенной внутренней оптимизацией (\autoref{table:solar_di}, \autoref{table:hmsfrs_di}) оптимальный порядок однозначно не устанавливается (3 либо 4). У $ n = 4 $ относительная ошибка старшего члена заметно меньше единицы и есть еще один точный член --- $ \theta_3 $. Кривая вращения для $ n = 4 $ выглядит на больших $ R $ более реалистично, чем для $ n = 3 $. Алгоритмы одномерного и трехмерного поиска выбросов исключили значительно больше объектов (для выборки HMSFRs это 42 объекта из 207 вместо 14). Это не удивительно: отклонения от модели теперь не объясняются ошибками в данных. В результате сокращения объема выборки почти для всех основных параметров (это параметры, отличные от $ \theta_i, \; i \ge 2 $), кроме $ R_0 $, точность ухудшилась. Для некоторых параметров есть заметные смещения: для $ A $, $ V_\odot $ и $ \theta_1 $. Радиальная и азимутальная дисперсия стали в 1.5--2 раза больше из-за того, что отклонения от модели, вызванные ошибками в расстояния, стали интерпретироваться как природная дисперсия. При этом эллипсоид скоростей стал нефизичным: азимутальная дисперсия превзошла радиальную. Вертикальная дисперсия не изменилась, т.к. для объектов, находящихся вблизи диска Галактики, ошибки в расстояниях почти не влияют на вертикальную скорость, а следовательно и на вертикальную дисперсию. Модельные кривые вращения допустимых порядков стали менее физичными: на больших $ R $ дают значительный формальный рост. Это потому, что у некоторых объектов при небольшой ошибке скорости имеется большая ошибка расстояния, а она не учитывается. Это аргумент в пользу необходимости учитывать неопределенность расстояний.

По сравнению с включенной внутренней оптимизацией, для варианта с оптимальной выборкой HMSFRs наблюдается сильное смещение для $ R_0 $, $ u_\odot $, $ v_\odot $, $ \sigma_R $, $ \sigma_\theta $, $ \theta_0 $, $ \theta_\odot $. Особенно важно смещение для $ R_0 $: 8.32 кпк ($ n_\text{o} = 4 $) вместо 7.92 кпк ($ n_\text{o} = 3 $). Выводы относительно понижения точности параметров
и нефизичности модельных кривых вращения аналогичны сделанным в предыдущем абзаце. Стоит отметить, что отключение проверок на выбросы для данного варианта неизбежно привело к получению профилей неправильной формы для многих параметров, что негативно повлияло на сходимость алгоритма (ожидающего локальный минимум во внешней оптимизации). Эффект этого проявляется, например, в резком скачке значения $ R_0 $ при $ n = 5 $. Это может быть аргументом в пользу того, что (гибкая) процедура исключения выбросов необходима.

Согласно полученным значениям статистик для ряда приведенных параллаксов (см. \autoref{table:solar}, \autoref{table:hmsfrs}, \autoref{fig:parallaxes}) можно заключить, что в целом расстояния до мазеров определяются правильно. Систематического смещения параллаксов, ни существенного, ни значимого (в отличие от параллаксов Gaia \cite{B.2021}), не обнаружено: по оптимальной модели для выборки HMSFRs среднее смещение составляет $ -0.95 \pm 1.00 $ мксд. Разброс величины $ \varpi_0 - \varpi $ по порядку величины согласуется с неопределенностью измерения параллаксов: величина $ \sigma $ близка к единице. Это говорит в пользу работоспособности алгоритма кинематической коррекции измерений параллаксов методом статистических параллаксов. Каталожные неопределенности параллаксов завышены на $ 1 / 5 $: $ \sigma = 0.804 \pm 0.041 $, а $ 1 / \sigma = 1.243 \pm 0.063 $. Это видно и на графике: характерная ширина баров ошибок явно больше ширины горизонтального сечения полосы $ \Delta\varpi \pm \sigma' $.

Дальнейшим улучшением алгоритма может стать моделирование неоднородности самой выборки, заключающееся в использовании вместо одного двух эллипсоидов скоростей: одного для объектов из каталога Рид и др. \cite{R.2019}, другого --- для всех остальных. Это позволит избавиться от необходимости учитывать неопределенности переноса движения мазеров к движению центральной звезды с помощью добавления произвольного члена в квадратах (значения $ \pm 5 $ км/с и $ \pm 10 $ км/с известны лишь со слов авторов \cite{R.2019}) и сделать это различие частью модели (т.е. добавить ещё три параметра). Это также позволит объединить объекты типа HMSFR с объектами типа SFR, тем самым повысив статистическую точность результата. Такое слияние уже делалось в других работах (например, \cite{R.2017}, \cite{VERA.2020}), однако без учета указанной неоднородности.

\newpage

\setcounter{secnumdepth}{-1}

\hyperlink{toc}{\section{Заключение}}

\begin{enumerate}
  \item Объединены и дополнены каталоги \cite{R.2019} и \cite{VERA.2020} мазерных источников. Новый каталог содержит наиболее полный на текущий момент набор кинематических данных (276 объектов).

  \item Разработан и реализован алгоритм пространственно"=кинематического моделирования однородной плоской подсистемы объектов Галактики по трехмерному полю скоростей, учитывающий случайные ошибки гелиоцентрических расстояний без ограничений на величину этих ошибок, а также включающий ряд таких усовершенствований, как определение остаточного движение Солнца, оптимизация сглаженности закона вращения, оценка природных дисперсий скоростей, применение гибкого алгоритма исключения выбросов в данных и другие. Метод применен к данным нового каталога.

  \item Выведена оценка расстояния от Солнца до центра Галактики $ R_0 = 7.92 \pm 0.12 $ кпк (выборка HMSFRs, $ n = 3 $), которая является в настоящий момент наиболее статистически точной из полученных по мазерным источникам. Найдены оценки для всех фундаментальных параметров Галактики с малыми статистическими ошибками.

  \item Систематического смещения параллаксов не обнаружено: по оптимальной модели для выборки HMSFRs их среднее смещение $ \Delta\varpi $ составляет $ -0.95 \pm 1.00 $ мксд. Однако показано, что указанные в каталогах неопределенности параллаксов мазеров завышены примерно на $ 1 / 5 $.

  \item При получении дополнительных вариантов результатов продемонстрирована необходимость учитывать неопределенность расстояний (в данном случае параллаксов) при пространственно-кинематическом моделировании даже в случае довольно точных и, как оказалось, несмещенных параллаксов мазерных источников. Также показана важность исключения объектов с большими невязками.
\end{enumerate}

\newpage

\printbibliography[heading=bibintoc]

\thispagestyle{empty}

\end{document}
